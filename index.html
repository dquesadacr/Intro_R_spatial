<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui"><title>Introduction to</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/reset.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/reveal.css"><link rel="stylesheet" href="./white.css" id="theme"><!--This CSS is generated by the Asciidoctor reveal.js converter to further integrate AsciiDoc's existing semantic with reveal.js--><style type="text/css">.reveal div.right {
  float: right
}

/* listing block */
.reveal .listingblock.stretch > .content {
  height: 100%
}

.reveal .listingblock.stretch > .content > pre {
  height: 100%
}

.reveal .listingblock.stretch > .content > pre > code {
  height: 100%;
  max-height: 100%
}

/* tables */
table {
  border-collapse: collapse;
  border-spacing: 0
}

table {
  margin-bottom: 1.25em;
  border: solid 1px #dedede
}

table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td {
  padding: .5em .625em .625em;
  font-size: inherit;
  text-align: left
}

table tr th, table tr td {
  padding: .5625em .625em;
  font-size: inherit
}

table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td {
  display: table-cell;
  line-height: 1.6
}

td.tableblock > .content {
  margin-bottom: 1.25em
}

td.tableblock > .content > :last-child {
  margin-bottom: -1.25em
}

table.tableblock, th.tableblock, td.tableblock {
  border: 0 solid #dedede
}

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock {
  border-width: 0 1px 1px 0
}

table.grid-all > tfoot > tr > .tableblock {
  border-width: 1px 1px 0 0
}

table.grid-cols > * > tr > .tableblock {
  border-width: 0 1px 0 0
}

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock {
  border-width: 0 0 1px
}

table.grid-rows > tfoot > tr > .tableblock {
  border-width: 1px 0 0
}

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child {
  border-right-width: 0
}

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock {
  border-bottom-width: 0
}

table.frame-all {
  border-width: 1px
}

table.frame-sides {
  border-width: 0 1px
}

table.frame-topbot, table.frame-ends {
  border-width: 1px 0
}

.reveal table th.halign-left, .reveal table td.halign-left {
  text-align: left
}

.reveal table th.halign-right, .reveal table td.halign-right {
  text-align: right
}

.reveal table th.halign-center, .reveal table td.halign-center {
  text-align: center
}

.reveal table th.valign-top, .reveal table td.valign-top {
  vertical-align: top
}

.reveal table th.valign-bottom, .reveal table td.valign-bottom {
  vertical-align: bottom
}

.reveal table th.valign-middle, .reveal table td.valign-middle {
  vertical-align: middle
}

table thead th, table tfoot th {
  font-weight: bold
}

tbody tr th {
  display: table-cell;
  line-height: 1.6
}

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p {
  font-weight: bold
}

thead {
  display: table-header-group
}

.reveal table.grid-none th, .reveal table.grid-none td {
  border-bottom: 0 !important
}

/* kbd macro */
kbd {
  font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
  display: inline-block;
  color: rgba(0, 0, 0, .8);
  font-size: .65em;
  line-height: 1.45;
  background: #f7f7f7;
  border: 1px solid #ccc;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em white inset;
  box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em #fff inset;
  margin: 0 .15em;
  padding: .2em .5em;
  vertical-align: middle;
  position: relative;
  top: -.1em;
  white-space: nowrap
}

.keyseq kbd:first-child {
  margin-left: 0
}

.keyseq kbd:last-child {
  margin-right: 0
}

/* callouts */
.conum[data-value] {
  display: inline-block;
  color: #fff !important;
  background: rgba(0, 0, 0, .8);
  -webkit-border-radius: 50%;
  border-radius: 50%;
  text-align: center;
  font-size: .75em;
  width: 1.67em;
  height: 1.67em;
  line-height: 1.67em;
  font-family: "Open Sans", "DejaVu Sans", sans-serif;
  font-style: normal;
  font-weight: bold
}

.conum[data-value] * {
  color: #fff !important
}

.conum[data-value] + b {
  display: none
}

.conum[data-value]:after {
  content: attr(data-value)
}

pre .conum[data-value] {
  position: relative;
  top: -.125em
}

b.conum * {
  color: inherit !important
}

.conum:not([data-value]):empty {
  display: none
}

/* Callout list */
.hdlist > table, .colist > table {
  border: 0;
  background: none
}

.hdlist > table > tbody > tr, .colist > table > tbody > tr {
  background: none
}

td.hdlist1, td.hdlist2 {
  vertical-align: top;
  padding: 0 .625em
}

td.hdlist1 {
  font-weight: bold;
  padding-bottom: 1.25em
}

/* Disabled from Asciidoctor CSS because it caused callout list to go under the
 * source listing when .stretch is applied (see #335)
 * .literalblock+.colist,.listingblock+.colist{margin-top:-.5em} */
.colist td:not([class]):first-child {
  padding: .4em .75em 0;
  line-height: 1;
  vertical-align: top
}

.colist td:not([class]):first-child img {
  max-width: none
}

.colist td:not([class]):last-child {
  padding: .25em 0
}

/* Override Asciidoctor CSS that causes issues with reveal.js features */
.reveal .hljs table {
  border: 0
}

/* Callout list rows would have a bottom border with some reveal.js themes (see #335) */
.reveal .colist > table th, .reveal .colist > table td {
  border-bottom: 0
}

/* Fixes line height with Highlight.js source listing when linenums enabled (see #331) */
.reveal .hljs table thead tr th, .reveal .hljs table tfoot tr th, .reveal .hljs table tbody tr td, .reveal .hljs table tr td, .reveal .hljs table tfoot tr td {
  line-height: inherit
}

/* Columns layout */
.columns .slide-content {
  display: flex;
}

.columns.wrap .slide-content {
  flex-wrap: wrap;
}

.columns.is-vcentered .slide-content {
  align-items: center;
}

.columns .slide-content > .column {
  display: block;
  flex-basis: 0;
  flex-grow: 1;
  flex-shrink: 1;
}

.columns .slide-content > .column > * {
  padding: .75rem;
}

/* See #353 */
.columns.wrap .slide-content > .column {
  flex-basis: auto;
}

.columns .slide-content > .column.is-full {
  flex: none;
  width: 100%;
}

.columns .slide-content > .column.is-four-fifths {
  flex: none;
  width: 80%;
}

.columns .slide-content > .column.is-three-quarters {
  flex: none;
  width: 75%;
}

.columns .slide-content > .column.is-two-thirds {
  flex: none;
  width: 66.6666%;
}

.columns .slide-content > .column.is-three-fifths {
  flex: none;
  width: 60%;
}

.columns .slide-content > .column.is-half {
  flex: none;
  width: 50%;
}

.columns .slide-content > .column.is-two-fifths {
  flex: none;
  width: 40%;
}

.columns .slide-content > .column.is-one-third {
  flex: none;
  width: 33.3333%;
}

.columns .slide-content > .column.is-one-quarter {
  flex: none;
  width: 25%;
}

.columns .slide-content > .column.is-one-fifth {
  flex: none;
  width: 20%;
}

.columns .slide-content > .column.has-text-left {
  text-align: left;
}

.columns .slide-content > .column.has-text-justified {
  text-align: justify;
}

.columns .slide-content > .column.has-text-right {
  text-align: right;
}

.columns .slide-content > .column.has-text-left {
  text-align: left;
}

.columns .slide-content > .column.has-text-justified {
  text-align: justify;
}

.columns .slide-content > .column.has-text-right {
  text-align: right;
}

.text-left {
  text-align: left !important
}

.text-right {
  text-align: right !important
}

.text-center {
  text-align: center !important
}

.text-justify {
  text-align: justify !important
}

.footnotes {
  border-top: 1px solid rgba(0, 0, 0, 0.2);
  padding: 0.5em 0 0 0;
  font-size: 0.65em;
  margin-top: 4em;
}
</style><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/v4-shims.min.css"><!--Printing and PDF exports--><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/print/pdf.css" : "https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><link rel="stylesheet" href="./custom_white.css"></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title"><h1>Introduction to <span class="image"><img src="./images/r-seeklogo.svg" alt="r seeklogo" height="69"></span></h1><div class="preamble"><div class="paragraph L-text bold"><p>Basics, <em>Tidyverse</em> and spatial data<br>
<br>
<em><a href="mailto:dannell.quesada@tu-dresden.de">Dánnell Quesada</a></em> <a href="https://github.com/dquesadacr"><span class="icon"><i class="fa fa-github"></i></span></a><br>
<br>
<em><a href="mailto:ahmed.homoudi@tu-dresden.de">Ahmed Homoudi</a></em> <a href="https://github.com/ahmathlete"><span class="icon"><i class="fa fa-github"></i></span></a><br>
<br>
<span class="image"><img src="./images/IHM.png" alt="IHM" height="170"></span>&#160;&#160;&#160;<span class="image"><img src="./images/Logo_TU_Dresden.svg" alt="Logo TU Dresden" height="170"></span></p></div>
<div class="paragraph"><p><br>
19/09/2022</p></div></div></section>
<section id="_outline" class="columns is-vcentered"><h2>Outline</h2><div class="slide-content"><div class="ulist column"><ul><li class="fragment"><p>Course details</p></li><li class="fragment"><p>Introduce ourselves</p><div class="ulist"><ul><li><p>Background</p></li><li><p>Experience&#8201;&#8212;&#8201;expectations</p></li></ul></div></li><li class="fragment"><p>Prerequisites</p></li><li class="fragment"><p>Basics</p><div class="ulist"><ul><li><p>Reserved words</p></li><li><p>Data types and structures</p></li><li><p>Operators</p></li><li><p>Libraries</p></li><li><p>Functions</p></li></ul></div></li></ul></div>
<div class="ulist column"><ul><li class="fragment"><p>Control structures</p></li><li class="fragment"><p>Distribution and statistics</p></li><li class="fragment"><p>Base-R plotting</p></li><li class="fragment"><p><em>Tidyverse</em></p><div class="ulist"><ul><li><p>Data wrangling</p></li><li><p>Intro to <em>ggplot2</em></p></li></ul></div></li><li class="fragment"><p>Spatial data</p><div class="ulist"><ul><li><p>Rasters</p></li><li><p>Vectors</p></li><li><p>Plotting</p></li></ul></div></li></ul></div></div></section>
<section id="_course_details"><h2>Course details</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>You can opt for a certificate of participation</p></li><li class="fragment"><p>Requisites:</p><div class="ulist"><ul><li class="fragment"><p>Assist to all lessons (sign attendance sheet daily)</p><div class="ulist"><ul><li><p>Absence justified only with <em>sick certificate</em> or<br>
major issue</p></li></ul></div></li><li class="fragment"><p>Do all exercises and final presentation</p><div class="ulist"><ul><li><p>You can work in couples</p></li></ul></div></li></ul></div></li></ul></div></div></section>
<section><section id="_background_dq"><h2>Background DQ</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>Studied Civil Engineering at the University of Costa Rica</p><div class="ulist"><ul><li><p>Worked for 3 years as hydrologist and hydraulic engineer<br>
for hydropower projects</p></li></ul></div></li><li class="fragment"><p><em>Hydroscience and Engineering</em> masters at the <em>TU Dresden</em></p><div class="ulist"><ul><li><p>Master thesis dealt with <em>statistical downscaling</em> of CMIP5<br>
projections for Costa Rica using machine learning (<a href="https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.6616">paper</a>)</p></li></ul></div></li><li class="fragment"><p>Doctoral candidate since 2020, <em>ESF</em> scholarship</p></li></ul></div></div></section><section id="_phd_project_dq"><h2>PhD project DQ</h2><div class="slide-content"><div class="dlist"><dl><dt class="hdlist1">Working title: </dt><dd><p><em>Potential species trajectories under climate change in low mountain ranges (Ore Mountains)</em></p></dd></dl></div>
<div class="olist arabic"><ol class="arabic"><li class="fragment"><p>Statistical downscaling of local variables with Deep Learning (DL, <a href="https://gmd.copernicus.org/preprints/gmd-2022-14/">paper</a>)</p><div class="ulist"><ul><li><p><a href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5">ERA5</a> dataset as predictors</p></li><li><p>Observations: <a href="https://rekis.hydro.tu-dresden.de/startseite/ueber-uns/">REKIS</a> gridded daily data, 1 km resolution (1961&#8201;&#8212;&#8201;2015)</p></li><li><p>Focus on precipitation &#8594; <em>extreme events</em></p></li></ul></div></li><li class="fragment"><p>Use <a href="https://www.wcrp-climate.org/wgcm-cmip/wgcm-cmip5">CMIP5</a>&#8201;&#8212;&#8201;<a href="https://euro-cordex.net/">EURO-CORDEX</a> model output to obtain an ensemble of<br>
downscaled climate projections (2005&#8201;&#8212;&#8201;2100)</p></li><li class="fragment"><p>Implement the generated high-resolution climate data in <em>Species<br>
Distribution Models</em> (SDMs) for the Ore Mountains</p><div class="ulist"><ul><li><p>Focus on endangered plant species of the region</p></li></ul></div></li></ol></div></div></section><section id="_background_ah"><h2>Background AH</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>Studied Civil Engineering at the University of Khartoum, Sudan</p><div class="ulist"><ul><li><p>Have three years experience in working as <em>Irrigation Engineer</em> at the Sudanese<br>
Federal Ministry of Water resources, <em>Resident Engineer</em> in the Construction Sector<br>
(Sudan), and <em>Teaching Assistant</em> in many sudanese universities</p></li></ul></div></li><li class="fragment"><p><em>Hydroscience and Engineering</em> masters at the <em>TU Dresden</em></p><div class="ulist"><ul><li><p>Master thesis theme: Objective Identification and Characterization of Double ITCZ<br>
in CMIP5 Models and its Effects on Regional Climate Models. (<a href="https://doi.org/10.21203/rs.3.rs-1787861/v1">preprint</a>)</p></li></ul></div></li><li class="fragment"><p>Research Assistant &amp; PhD Student since October 2021</p></li></ul></div></div></section><section id="_phd_project_ah"><h2>PhD project AH</h2><div class="slide-content"><div class="dlist"><dl><dt class="hdlist1">Working title: </dt><dd><p><em>Convective Precipitation Systems on the Arabian Peninsula: Current Situation and
Future Trends</em></p></dd></dl></div>
<div class="olist arabic"><ol class="arabic"><li class="fragment"><p>Identification and Description of Precipitation systems using Object Based Methods (OBM)<br>
and Tracking algorithm</p><div class="ulist"><ul><li><p><a href="https://disc.gsfc.nasa.gov/datasets/GPM_3IMERGDF_06/summary">GPM</a> dataset as input</p></li></ul></div></li><li class="fragment"><p>Linkage of Meso- to Synoptic-Scale Predictors to precipitation Regimes</p><div class="ulist"><ul><li><p><a href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5">ERA5</a> dataset to obtain predictors (i.e. atmospheric conditions) concurrent to<br>
precipitation systems</p></li></ul></div></li><li class="fragment"><p>Dynamically downscale <a href="https://www.wcrp-climate.org/wgcm-cmip/wgcm-cmip5">CMIP6</a> models output to obtain convective resolved precipitation<br>
projections (i.e. 1 km)</p><div class="ulist"><ul><li><p>The <a href="https://www.mmm.ucar.edu/weather-research-and-forecasting-model">WRF</a> will be used for downscaling, and OBM will applied to its output to<br>
communicate uncertainties</p></li></ul></div></li></ol></div></div></section><section id="_your_turn"><h2>Your turn!</h2><div class="slide-content"><div class="ulist"><ul><li><p>Background</p></li><li><p>Programming experience?</p></li><li><p>Expectations of this course</p></li></ul></div></div></section></section>
<section id="_prerequisites"><h2>Prerequisites</h2><div class="slide-content"><div class="olist arabic"><ol class="arabic"><li><p>Install <span class="image"><img src="./images/r-seeklogo.svg" alt="r seeklogo" height="45"></span>, version <em>4.x</em>:</p><div class="ulist"><ul><li><p>Download from <a href="https://cloud.r-project.org/" class="bare">https://cloud.r-project.org/</a></p></li><li><p>I encountered package compatibility issues with <em>v4.2</em> some<br>
months ago, if persistent, install <em>v4.1.3</em> from <a href="https://cloud.r-project.org/bin/windows/base/old/4.1.3/R-4.1.3-win.exe">here (Windows)</a></p></li></ul></div></li><li><p>Install <span class="image"><img src="./images/RStudio_logo_flat.svg" alt="RStudio logo flat" height="45"></span></p><div class="ulist"><ul><li><p>Download from <a href="https://www.rstudio.com/products/rstudio/download/#download">here</a></p></li></ul></div></li><li><p><em>Swirl</em> exercises</p></li></ol></div></div></section>
<section id="_reserved_words"><h2>Reserved words</h2><div class="slide-content"><div class="ulist"><ul><li><p>There are some words that have a special meaning in <span class="image"><img src="./images/r-seeklogo.svg" alt="r seeklogo" height="45"></span>:</p></li></ul></div>
<div class="paragraph"><p><br></p></div>
<table class="tableblock frame-none grid-none" style="width:65%"><colgroup><col style="width:20%"><col style="width:20%"><col style="width:20%"><col style="width:20%"><col style="width:20%"></colgroup><tbody><tr><td class="tableblock halign-center valign-top"><p class="tableblock">if</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">else</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">repeat</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">while</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">function</p></td></tr><tr><td class="tableblock halign-center valign-top"><p class="tableblock">for</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">in</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">next</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">break</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">TRUE</p></td></tr><tr><td class="tableblock halign-center valign-top"><p class="tableblock">FALSE</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">NULL</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">Inf</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">NaN</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">NA</p></td></tr><tr><td class="tableblock halign-center valign-top"><p class="tableblock">NA_integer_</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">NA_real_</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">NA_complex_</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">NA_character_</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">…</p></td></tr></table></div></section>
<section id="_variables_and_constants"><h2>Variables and constants</h2><div class="slide-content"><div class="ulist"><ul><li><p>Variables are used to store data, which can be changed afterwards</p></li><li><p>The name given to a variable is known as <em>identifier</em></p></li><li><p>Rules for <em>identifiers</em>:</p><div class="ulist"><ul><li><p>Can be a combination of letters, digits, period (<code>.</code>) and underscore (<code>_</code>)</p></li><li><p>Needs to start with a letter or period</p><div class="ulist"><ul><li><p>If starts with period, can not be followed by a digit, e.g. <code>.4var</code></p></li></ul></div></li><li><p><em>Reserved words</em> can not be used as <em>identifiers</em></p></li></ul></div></li><li><p><em>Constants</em> can not be modified, like <em>numbers</em> and <em>strings</em></p></li></ul></div></div></section>
<section><section id="_basic_data_types"><h2>Basic data types</h2><div class="slide-content"><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">Everything in <span class="image"><img src="./images/r-seeklogo.svg" alt="r seeklogo" height="45"></span> is an <strong><em>object</em></strong><br>
This basic data types are also known as <em>atomic classes</em><br>
<span class="image"><img src="./images/r-seeklogo.svg" alt="r seeklogo" height="45"></span> is <em>case sensitive</em></td></tr></table></div><div class="paragraph"><p><br></p></div><div class="openblock col2"><div class="content"><div class="ulist"><ul><li class="fragment"><p><strong>Logical</strong></p><div class="ulist"><ul><li><p>TRUE, FALSE</p></li></ul></div></li><li class="fragment"><p><strong>Numeric</strong></p><div class="ulist"><ul><li><p>3, 1.5, pi</p></li><li><p>Real or decimal, <em>floating numbers</em></p></li><li><p>Also known as <em>double</em></p></li></ul></div></li><li class="fragment"><p><strong>Integer</strong></p><div class="ulist"><ul><li><p>2L, 11L</p></li><li><p>Note the <strong><em>L</em></strong></p></li></ul></div></li></ul></div></div></div><div class="openblock col2"><div class="content"><div class="ulist"><ul><li class="fragment"><p><strong>Complex</strong></p><div class="ulist"><ul><li><p>1+2i, 4+7i</p></li></ul></div></li><li class="fragment"><p><strong>Characters</strong></p><div class="ulist"><ul><li><p>"A", 'climate', "38.89", 'FALSE'</p></li><li><p>Note that either <em>single</em> or <em>double</em> quotes<br>
surround the desired <em>string</em></p></li></ul></div></li><li class="fragment"><p><strong>Raw</strong></p><div class="ulist"><ul><li><p>Hexadecimal representation of data</p></li></ul></div></li></ul></div></div></div></div></section><section id="_checking_the_data_types" class="columns is-vcentered"><h2>Checking the data types</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">y &lt;- TRUE
class(y) # Function to ask: What is it?
[1] "logical"

x &lt;- pi/2
typeof(x) # Similar
[1] "double"

z &lt;- 3L
storage.mode(z) # Also!
[1] "integer"

str(z) # Structure!
 int 3</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">u &lt;- 1 + 2i
class(u)
[1] "complex"

v &lt;- "Corcovado"
typeof(v)
[1] "character"

w &lt;- charToRaw("Learning R")
print(w)
[1] 4c 65 61 72 6e 69 6e 67 20 52

storage.mode(w)
[1] "raw"</code></pre></div></div></div></div></div></section></section>
<section id="_data_structures" class="columns is-vcentered"><h2>Data structures</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li class="fragment"><p><strong>Vectors</strong></p><div class="ulist"><ul><li><p>Most basic data object</p></li><li><p>Collection of <em>atomic elements</em></p></li><li><p>Two types:</p><div class="ulist"><ul><li><p>Atomic vector</p></li><li><p>List</p></li></ul></div></li></ul></div></li><li class="fragment"><p><strong>Lists</strong></p><div class="ulist"><ul><li><p><em>Universal</em> container</p></li><li><p>Unlike vectors, not restricted to be of<br>
a single <em>type</em></p></li></ul></div></li><li class="fragment"><p><strong>Matrices</strong></p><div class="ulist"><ul><li><p>Two-dimensional layout of elements of<br>
the <strong>same</strong> type</p></li></ul></div></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li class="fragment"><p><strong>Arrays</strong></p><div class="ulist"><ul><li><p>Can contain data of more than two dimensions</p></li><li><p>Just one <em>atomic</em> type</p></li><li><p>Contigous memory allocation</p></li></ul></div></li><li class="fragment"><p><strong>Data frames</strong></p><div class="ulist"><ul><li><p>Two-dimensional structure</p></li><li><p>Columns contain the value of one variable</p></li><li><p>Rows contain the values of each column</p></li></ul></div></li><li class="fragment"><p><strong>Factors</strong></p><div class="ulist"><ul><li><p>Used to categorize data and store it as levels</p></li><li><p>Can be <em>strings</em> and <em>integers</em></p></li></ul></div></li></ul></div></div></div></div></section>
<section><section id="_operators"><h2>Operators</h2><div class="slide-content"><div class="imageblock"><img src="./images/all.png" alt="all" height="800"></div></div></section><section id="_testing_the_operators" class="columns is-vcentered"><h2>Testing the operators</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">x &lt;- 2
y &lt;- 7
x+y
[1] 9
x-y
[1] -5
x*y
[1] 14
x/y
[1] 0.2857143
x%/%y
[1] 0
x%%y
[1] 2
x^y
[1] 128</code></pre></div></div>
<div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">x &lt;- 2
y &lt;- 7
x&lt;y
[1] TRUE
x&gt;y
[1] FALSE
x&gt;=35
[1] FALSE
x&lt;=35
[1] TRUE
y==10
[1] FALSE
x!=y
[1] TRUE
y!=10
[1] TRUE</code></pre></div></div>
<div class="listingblock column is-half"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">a &lt;- c(TRUE,TRUE,FALSE,0,6,7)
b &lt;- c(FALSE,TRUE,FALSE,TRUE,TRUE,TRUE)
a&amp;b
[1] FALSE  TRUE FALSE FALSE  TRUE  TRUE
a&amp;&amp;b
[1] FALSE
a|b
[1]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
a||b
[1] TRUE
!a
[1] FALSE FALSE  TRUE  TRUE FALSE FALSE
!b
[1]  TRUE FALSE  TRUE FALSE FALSE FALSE</code></pre></div></div></div></section></section>
<section><section id="_functions"><h2>Functions</h2><div class="slide-content"><div class="ulist"><ul><li><p>There are thousands of functions implemented on base-<span class="image"><img src="./images/r-seeklogo.svg" alt="r seeklogo" height="45"></span>, e.g.:</p><div class="ulist"><ul><li><p><code>sin(pi/2)</code>, <code>log(x)</code>, <code>max(y)</code>, <code>min(z)</code></p></li></ul></div></li><li><p>Functions have the following structure:</p><div class="ulist"><ul><li><p><code>function ( argument list ) {body}</code></p></li><li><p>Note the parentheses types above</p></li></ul></div></li><li><p>When the functions have several arguments, they should be given<br>
in the predefined order</p></li><li><p>Or, provide them with the corresponding names:</p><div class="ulist"><ul><li><p><code>plot(1:6, c(5,1,3, 4, 3, 6), type = "l", col = "blue")</code></p></li></ul></div></li><li><p>Users can define functions:</p></li></ul></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">sum_squares &lt;- function(x) {
    return(sum(x**2))
}
z &lt;- 1:5
sum_squares(z)
[1] 55</code></pre></div></div></div></section><section id="_other_useful_base_functions" class="columns is-vcentered"><h2>Other useful base functions</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><code>abs</code> &#8594; Compute the absolute value of a numeric data object</p></li><li><p><code>attributes</code> &#8594; Return or set all attributes of a data object</p></li><li><p><code>c</code> &#8594; Combine values into a vector or list</p></li><li><p><code>cat</code> &#8594; Return character string in readable format</p></li><li><p><code>cbind</code> &#8594; Combine vectors, matrices and/or data frames by column</p></li><li><p><code>ceiling</code> &#8594; Round numeric up to the next higher integer</p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><code>do.call</code> &#8594; Execute function by its name and a list of corresponding arguments</p></li><li><p><code>floor</code> &#8594; Round numeric down to the next lower integer</p></li><li><p><code>gc</code> &#8594; Collect garbage to clean up memory</p></li><li><p><code>hist</code> &#8594; Create histogram</p></li><li><p><code>lapply</code> &#8594; Apply function to all list elements</p></li><li><p><code>ls</code> &#8594; List all variables in the environment</p></li><li><p><code>ncol</code> &#8594; Return the number of columns of a matrix or data frame</p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><code>print</code> &#8594; Return data object to the console</p></li><li><p><code>rbind</code> &#8594; Combine vectors, matrices and/or data frames by row</p></li><li><p><code>rm</code> &#8594; Clear specific data object from R workspace</p></li><li><p><code>rep</code> &#8594; Replicate elements of vectors and lists</p></li><li><p><code>sd</code> &#8594; Compute standard deviation</p></li><li><p><code>setwd</code> &#8594; Change the current working directory</p></li><li><p><code>t</code> &#8594; Transpose data frame</p></li><li><p><code>var</code> &#8594; Compute sample variance</p></li></ul></div></div></div></div></section><section id="_functions_help"><h2>Function&#8217;s help</h2><div class="slide-content"><div class="ulist"><ul><li><p>There is a comprehensive pre-built help system</p></li><li><p>To access it, try the following from the command prompt:</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">help.start()   # general help
help(foo)      # help about function foo
?foo           # same thing
apropos("foo") # list all functions containing string foo
example(foo)   # show an example of function foo</code></pre></div></div></div></section></section>
<section id="_using_libraries"><h2>Using libraries</h2><div class="slide-content"><div class="ulist"><ul><li><p><code>install.packages("tidyverse")</code> &#8594; install new libraries</p><div class="ulist"><ul><li><p><em>tidyverse</em> is very useful, will come back to it later</p></li></ul></div></li><li><p><code>library(tidyverse)</code> &#8594; loads the package into the active session</p><div class="ulist"><ul><li><p>Installing the libraries is not enough to use the functions they contain</p></li></ul></div></li><li><p><code>dplyr::select</code> &#8594; use the <code>select</code> function from <code>dplyr</code> without loading<br>
the whole library</p></li></ul></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">The form <code>library::function</code> is considered good practice, particularly<br>
when several libraries have the same function name (avoids conflicts)</td></tr></table></div></div></section>
<section><section id="_vectors"><h2>Vectors</h2><div class="slide-content"><div class="ulist"><ul><li><p>Several ways of creating vectors:</p></li></ul></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">c("a","B","c")
[1] "a" "B" "c"

1:8 # Creates consecutive integers
[1] 1 2 3 4 5 6 7 8

seq(1, 3, by=0.5) # Increment given
[1] 1.0 1.5 2.0 2.5 3.0

rep(1:2, times=3)
[1] 1 2 1 2 1 2

rep(1:2, each=3) # Notice the difference from the previous
[1] 1 1 1 2 2 2

vector(mode = "raw", length = 5)
[1] 00 00 00 00 00</code></pre></div></div><div class="ulist"><ul><li><p>They all can of course be saved into a variable&#8230;&#8203;</p></li></ul></div></div></section><section id="_selecting_vector_elements" class="columns is-vcentered"><h2>Selecting vector elements</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">x &lt;- c(-5, -2, 1, 3:6, 8, 10)
x
[1] -5 -2  1  3  4  5  6  8 10

x[5] # Access the fifth element
[1] 4

x[-3] # All but the third
[1] -5 -2  3  4  5  6  8 10

x[2:4] # Elements two to four
[1] -2  1  3

x[-(2:4)] # All elements but two to four
[1] -5  4  5  6  8 10</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">x[c(2,5)] # Elements two and five
[1] -2  4

x[x == 10] # Elements equal to 10
[1] 10

x[x &lt; 0] # Elements less than zero
[1] -5 -2

x[x &gt;= 3] # Elements greater or equal than three
[1]  3  4  5  6  8 10

x[x %in% c(1,2,5)] # Elements in the set 1,2,5
[1] 1 5</code></pre></div></div></div></div></div></section></section>
<section><section id="_matrices" class="columns is-vcentered"><h2>Matrices</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">y &lt;- matrix(1:16, nrow = 4, byrow = FALSE)
# byrow = FALSE is the default
y
     [,1] [,2] [,3] [,4]
[1,]    1    5    9   13
[2,]    2    6   10   14
[3,]    3    7   11   15
[4,]    4    8   12   16

y &lt;- matrix(1:16, nrow = 4, byrow = TRUE)
# Note how it changes the order
y
     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    6    7    8
[3,]    9   10   11   12
[4,]   13   14   15   16

class(y)
[1] "matrix" "array"
typeof(y)
[1] "integer"
dim(y) # Show the dimensions of the object
[1] 4 4</code></pre></div></div></div></div><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Binding vectors also creates matrices
z &lt;- cbind(c("A", "B", "C"), c("a", "b", "c"))
class(z)
[1] "matrix" "array"

typeof(z)
[1] "character"

dim(z)
[1] 3 2

# Recycling of elements
x &lt;- matrix(c(TRUE, FALSE), nrow = 3, ncol = 2)
x
      [,1]  [,2]
[1,]  TRUE FALSE
[2,] FALSE  TRUE
[3,]  TRUE FALSE

typeof(x)
[1] "logical"</code></pre></div></div></div></div></div></section><section id="_matrices_elements" class="columns is-vcentered"><h2>Matrices elements</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">y &lt;- matrix(1:24, nrow = 4, byrow = TRUE)
y[2,] # Access the second row
[1]  7  8  9 10 11 12

y[,4] # Access the fourth column
[1]  4 10 16 22

y[3,5] # Element on the third row and fifth column
[1] 17

y[2:3, 4:5] # Elements between the second and third row
# and the fourth and fifth column
     [,1] [,2]
[1,]   10   11
[2,]   16   17

y[4:1,] # Change the order of the rows
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]   19   20   21   22   23   24
[2,]   13   14   15   16   17   18
[3,]    7    8    9   10   11   12
[4,]    1    2    3    4    5    6</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">z &lt;- matrix(1:24, nrow = 5, byrow = FALSE)
Warning message:
In matrix(1:24, nrow = 5, byrow = FALSE) :
  data length [24] is not a sub-multiple or
  multiple of the number of rows [5]

z
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    6   11   16   21
[2,]    2    7   12   17   22
[3,]    3    8   13   18   23
[4,]    4    9   14   19   24
[5,]    5   10   15   20    1

z[5,5] &lt;- 25 # Modify element

z[21:25] # Access also as if it was a vector
[1] 21 22 23 24 25</code></pre></div></div></div></div></div></section></section>
<section id="_arrays" class="columns is-vcentered"><h2>Arrays</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">v &lt;- array(1:24, dim = c(4,3,2))
v # Ordered column-wise
, , 1

     [,1] [,2] [,3]
[1,]    1    5    9
[2,]    2    6   10
[3,]    3    7   11
[4,]    4    8   12

, , 2

     [,1] [,2] [,3]
[1,]   13   17   21
[2,]   14   18   22
[3,]   15   19   23
[4,]   16   20   24

class(v)
[1] "array"

typeof(v)
[1] "integer"</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">dim(v)
[1] 4 3 2

str(v)
 int [1:4, 1:3, 1:2] 1 2 3 4 5 6 7 8 9 10 ...

v[2,3,2] # Access single element
[1] 22

v[, 2, 1] # Access second column of first layer
[1] 5 6 7 8

v[4, ,2] # Access fourth row of second layer
[1] 16 20 24

v[3,,] # Access third row of all the layers
     [,1] [,2]
[1,]    3   15
[2,]    7   19
[3,]   11   23</code></pre></div></div></div></div></div></section>
<section><section id="_dataframes"><h2>Dataframes</h2><div class="slide-content"><div class="ulist"><ul><li><p>A dataframe is a two-dimensional structure</p></li><li><p>The columns should be named</p></li><li><p>Row names, if existent, should be unique</p></li><li><p>Data can be <em>numeric</em>, <em>factors</em> or <em>strings</em></p></li><li><p>Several ways to create a <em>dataframe</em></p></li></ul></div></div></section><section id="_data_frame_function"><h2>data.frame function</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">df &lt;- data.frame(id = c(1:5),
                 Names = c("Nick", "Dan", "Lis", "Kate", "Jose"),
                 Salary = c(1900, 1750, 2100, 2500, 2100),
                 start_date = as.Date(c("2012-01-01","2013-09-23","2014-11-15",
                 "2014-05-11","2015-03-27")))
str(df) # Notice the different types
'data.frame':|5 obs. of  4 variables:
 $ id        : int  1 2 3 4 5
 $ Names     : chr  "Nick" "Dan" "Lis" "Kate" ...
 $ Salary    : num  1900 1750 2100 2500 2100
 $ start_date: Date, format: "2012-01-01" "2013-09-23" "2014-11-15" "2014-05-11" ...

print(summary(df)) # summary function calculates some statistics
       id       Names               Salary       start_date
 Min.   :1   Length:5           Min.   :1750   Min.   :2012-01-01
 1st Qu.:2   Class :character   1st Qu.:1900   1st Qu.:2013-09-23
 Median :3   Mode  :character   Median :2100   Median :2014-05-11
 Mean   :3                      Mean   :2070   Mean   :2014-01-14
 3rd Qu.:4                      3rd Qu.:2100   3rd Qu.:2014-11-15
 Max.   :5                      Max.   :2500   Max.   :2015-03-27</code></pre></div></div></div></section><section id="_from_vectors"><h2>From vectors</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">df1 &lt;- cbind(id, Names, Salary, start_date)
str(df1)
# Note that its coerced as all strings

 chr [1:5, 1:4] "1" "2" "3" "4" "5" "Nick" "Dan" "Lis" "Kate" "Jose" "1900" "1750" "2100" "2500" "2100" ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr [1:4] "id" "Names" "Salary" "start_date"

df2 &lt;- cbind.data.frame(id, Names, Salary, start_date)
str(df2)
# Now is ok!
'data.frame':|5 obs. of  4 variables:
 $ id        : int  1 2 3 4 5
 $ Names     : chr  "Nick" "Dan" "Lis" "Kate" ...
 $ Salary    : num  1900 1750 2100 2500 2100
 $ start_date: Date, format: "2012-01-01" "2013-09-23" "2014-11-15" "2014-05-11" ...</code></pre></div></div></div></section><section id="_adding_data"><h2>Adding data</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">df$dept &lt;- c("IT","Operations","IT","HR","Finance") # Add additional columns
df
  id Names Salary start_date       dept
1  1  Nick   1900 2012-01-01         IT
2  2   Dan   1750 2013-09-23 Operations
3  3   Lis   2100 2014-11-15         IT
4  4  Kate   2500 2014-05-11         HR
5  5  Jose   2100 2015-03-27    Finance

new.employee &lt;- data.frame(id= 6, Names= "Ana", Salary=2300,
                           start_date = as.Date("2016-05-01"),
                           dept = "IT")
# Note that the column names should match
df &lt;- rbind(df, new.employee)
print(df)
  id Names Salary start_date       dept
1  1  Nick   1900 2012-01-01         IT
2  2   Dan   1750 2013-09-23 Operations
3  3   Lis   2100 2014-11-15         IT
4  4  Kate   2500 2014-05-11         HR
5  5  Jose   2100 2015-03-27    Finance
6  6   Ana   2300 2016-05-01         IT
7  6   Ana   2300 2016-05-01         IT</code></pre></div></div></div></section><section id="_column_names_need_to_match"><h2>Column names need to match!</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">#Note ID instead of id

new.employee &lt;- data.frame(ID= 6, Names= "Ana", Salary=2300,
                           start_date = as.Date("2016-05-01"),
                           dept = "IT")
df &lt;- rbind(df, new.employee)

Error in match.names(clabs, names(xi)) :
  names do not match previous names

# Also, subsetting according to a value:
subset(df, dept=="IT")
  id Names Salary start_date dept
1  1  Nick   1900 2012-01-01   IT
3  3   Lis   2100 2014-11-15   IT</code></pre></div></div></div></section><section id="_load_csv_file"><h2>Load csv file</h2><div class="slide-content"><div class="ulist"><ul><li><p>Download and unzip <a href="https://simplemaps.com/static/data/world-cities/basic/simplemaps_worldcities_basicv1.74.zip">this file</a> to a desired <em>path</em></p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">cities &lt;- read.csv(file = "/home/dqc/Downloads/simplemaps_worldcities_basicv1.74/worldcities.csv",
                   header = TRUE, sep = ",", dec = ".") # Change path accordingly!
# Note that the delimiters and decimal separator can be changed
nrow(cities)
[1] 41001

head(cities) # head() prints only the first 6 rows
      city city_ascii     lat      lng     country iso2 iso3  admin_name capital population         id
1    Tokyo      Tokyo 35.6897 139.6922       Japan   JP  JPN       Tōkyō primary   37977000 1392685764
2  Jakarta    Jakarta -6.2146 106.8451   Indonesia   ID  IDN     Jakarta primary   34540000 1360771077
3    Delhi      Delhi 28.6600  77.2300       India   IN  IND       Delhi   admin   29617000 1356872604
4   Mumbai     Mumbai 18.9667  72.8333       India   IN  IND Mahārāshtra   admin   23355000 1356226629
5   Manila     Manila 14.6000 120.9833 Philippines   PH  PHL      Manila primary   23088000 1608618140
6 Shanghai   Shanghai 31.1667 121.4667       China   CN  CHN    Shanghai   admin   22120000 1156073548

tail(cities, 2) # tail() the last 6, but can be changed
             city  city_ascii     lat      lng   country iso2 iso3         admin_name capital population
41000 Timmiarmiut Timmiarmiut 62.5333 -42.2167 Greenland   GL  GRL           Kujalleq                 10
41001     Nordvik     Nordvik 74.0165 111.5100    Russia   RU  RUS Krasnoyarskiy Kray                  0
              id
41000 1304206491
41001 1643587468</code></pre></div></div></div></section><section id="_other_ways_of_importing"><h2>Other ways of importing</h2><div class="slide-content"><div class="ulist"><ul><li><p><em>File</em> &#8594; <em>Import dataset</em> &#8594; <em>From text</em></p><div class="ulist"><ul><li><p><em>(base)</em> &#8594; same as before but with visual help</p></li><li><p><em>(readr)</em> &#8594; using the <em>readr</em> library</p></li></ul></div></li></ul></div>
<div class="imageblock"><img src="./images/readr.png" alt="readr" height="750"></div></div></section></section>
<section><section id="_factors"><h2>Factors</h2><div class="slide-content"><div class="ulist"><ul><li><p><em>Factors</em> categorize the data and store it as levels</p></li><li><p>Use strings and integers</p></li><li><p>Will prove very useful with <em>tidyverse</em> and plotting with <em>ggplot2</em></p></li></ul></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">data &lt;- c("East","West","East","North","North","East","West","West","West","East","North")
print(data)
 [1] "East"  "West"  "East"  "North" "North" "East"  "West"  "West"  "West"  "East"  "North"

print(is.factor(data))
[1] FALSE

factor_data &lt;- factor(data) # Change the data to factors
print(factor_data)
 [1] East  West  East  North North East  West  West  West  East  North
Levels: East North West

print(is.factor(factor_data))
[1] TRUE</code></pre></div></div></div></section><section id="_factors_in_data_frames"><h2>Factors in data frames</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">height &lt;- c(132,151,162,139,166,147,122)
weight &lt;- c(48,49,66,53,67,52,40)
gender &lt;- c("male","male","female","female","male","female","male")

input_data &lt;- data.frame(height,weight,gender, stringsAsFactors = TRUE) # Create DF
# Note stringsAsFactors, changed to default FALSE from R 4.0

print(is.factor(input_data$gender))
[1] TRUE

print(input_data$gender)
[1] male   male   female female male   female male
Levels: female male

str(input_data)
'data.frame':|7 obs. of  3 variables:
 $ height: num  132 151 162 139 166 147 122
 $ weight: num  48 49 66 53 67 52 40
 $ gender: Factor w/ 2 levels "female","male": 2 2 1 1 2 1 2</code></pre></div></div></div></section><section id="_change_order_of_factors"><h2>Change order of factors</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">data &lt;- c("East","West","East","North","North","East","West",
          "West","West","East","North")
factor_data &lt;- factor(data)
print(factor_data)
 [1] East  West  East  North North East  West  West  West  East  North
Levels: East North West

new_order_data &lt;- factor(factor_data,levels = c("East","West","North"))
print(new_order_data)
 [1] East  West  East  North North East  West  West  West  East  North
Levels: East West North</code></pre></div></div></div></section></section>
<section><section id="_lists"><h2>Lists</h2><div class="slide-content"><div class="ulist"><ul><li><p>Universal container &#8594; Can contain every other structure type</p></li></ul></div><div class="openblock col2"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">list_data &lt;- list("Red", "Green", c(21,32,11),
                  TRUE, 51.23, 119.1)
print(list_data)
[[1]]
[1] "Red"
[[2]]
[1] "Green"
[[3]]
[1] 21 32 11
[[4]]
[1] TRUE
[[5]]
[1] 51.23
[[6]]
[1] 119.1
str(list_data)
List of 6
 $ : chr "Red"
 $ : chr "Green"
 $ : num [1:3] 21 32 11
 $ : logi TRUE
 $ : num 51.2
 $ : num 119</code></pre></div></div></div></div><div class="openblock col2"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">list_data &lt;- list(c("Jan","Feb","Mar"),
             matrix(c(3,9,5,1,-2,8), nrow = 2),
             list("green",12.3))
str(list_data)
List of 3
 $ : chr [1:3] "Jan" "Feb" "Mar"
 $ : num [1:2, 1:3] 3 9 5 1 -2 8
 $ :List of 2
  ..$ : chr "green"
  ..$ : num 12.3

names(list_data) &lt;- c("1st Quarter", "Matrix", "Random")
str(list_data)
List of 3
 $ 1st Quarter: chr [1:3] "Jan" "Feb" "Mar"
 $ Matrix     : num [1:2, 1:3] 3 9 5 1 -2 8
 $ Other list :List of 2
  ..$ : chr "green"
  ..$ : num 12.3</code></pre></div></div></div></div></div></section><section id="_lists_ii"><h2>Lists II</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">list1 &lt;- list(w=matrix(12:1, nrow = 4), x=c(1,5,7,11), y=c(TRUE,FALSE), z="Blah")
str(list1)
List of 4
 $ w: int [1:4, 1:3] 12 11 10 9 8 7 6 5 4 3 ...
 $ x: num [1:4] 1 5 7 11
 $ y: logi [1:2] TRUE FALSE
 $ z: chr "Blah"

list2 &lt;- list(u=2:6, v=list1) # Merging lists
str(list2)
# Note the tree-like structure
List of 2
 $ u: int [1:5] 2 3 4 5 6
 $ v:List of 4
  ..$ w: int [1:4, 1:3] 12 11 10 9 8 7 6 5 4 3 ...
  ..$ x: num [1:4] 1 5 7 11
  ..$ y: logi [1:2] TRUE FALSE
  ..$ z: chr "Blah"</code></pre></div></div></div></section><section id="_accessing_elements_of_lists"><h2>Accessing elements of lists</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">list2[1] # Content of first element as a list
$u
[1] 2 3 4 5 6

list2[[1]] # Contents of first element
[1] 2 3 4 5 6
list2$v # Accessing by names
$w
     [,1] [,2] [,3]
[1,]   12    8    4
[2,]   11    7    3
[3,]   10    6    2
[4,]    9    5    1

$x
[1]  1  5  7 11

$y
[1]  TRUE FALSE

$z
[1] "Blah"

list2$v$z # Nested list by name
[1] "Blah"</code></pre></div></div></div></section><section id="_convert_list_to_vector"><h2>Convert list to vector</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">unlist(list2)
     u1      u2      u3      u4      u5    v.w1    v.w2    v.w3    v.w4    v.w5    v.w6    v.w7    v.w8    v.w9
    "2"     "3"     "4"     "5"     "6"    "12"    "11"    "10"     "9"     "8"     "7"     "6"     "5"     "4"
  v.w10   v.w11   v.w12    v.x1    v.x2    v.x3    v.x4    v.y1    v.y2     v.z
    "3"     "2"     "1"     "1"     "5"     "7"    "11"  "TRUE" "FALSE"  "Blah"</code></pre></div></div>
<div class="openblock col2"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">unlist(list2, recursive = FALSE) # Remove only the first level
$u1
[1] 2

$u2
[1] 3

$u3
[1] 4

$u4
[1] 5

$u5
[1] 6</code></pre></div></div></div></div>
<div class="openblock col2"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">$v.w
     [,1] [,2] [,3]
[1,]   12    8    4
[2,]   11    7    3
[3,]   10    6    2
[4,]    9    5    1

$v.x
[1]  1  5  7 11

$v.y
[1]  TRUE FALSE

$v.z
[1] "Blah"</code></pre></div></div></div></div></div></section></section>
<section id="_apply_functions"><h2><em>apply</em> functions</h2><div class="slide-content"><div class="openblock col2"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">df &lt;- data.frame(matrix(1:20, nrow = 4))
print(df)
  X1 X2 X3 X4 X5
1  1  5  9 13 17
2  2  6 10 14 18
3  3  7 11 15 19
4  4  8 12 16 20

apply(df, MARGIN = 1, sum) # apply function row-wise
[1] 45 50 55 60

apply(df, MARGIN = 1, mean)
[1]  9 10 11 12

apply(df, MARGIN = 2, sum) # column-wise
X1 X2 X3 X4 X5
10 26 42 58 74</code></pre></div></div></div></div>
<div class="openblock col2"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Note that their are applied column-wise (MARGIN=2)

lapply(df, mean) # "list" apply, returns list
$X1
[1] 2.5
$X2
[1] 6.5
$X3
[1] 10.5
$X4
[1] 14.5
$X5
[1] 18.5

sapply(df, mean) # "simple" apply, returns vector
  X1   X2   X3   X4   X5
 2.5  6.5 10.5 14.5 18.5</code></pre></div></div></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">User defined functions can be used</td></tr></table></div></div></section>
<section><section id="_control_structures"><h2>Control structures</h2><div class="slide-content"><div class="ulist"><ul><li><p><em>if</em>&#8201;&#8212;&#8201;<em>if-else</em></p></li><li><p><em>ifelse</em></p></li><li><p><em>for</em></p></li><li><p><em>while</em></p></li><li><p><em>repeat</em></p></li><li><p><em>switch</em></p></li></ul></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">Several <em>reserved words</em> are used here</td></tr></table></div></div></section><section id="_if_else"><h2><em>if-else</em></h2><div class="slide-content"><div class="ulist"><ul><li><p>The general syntax of an <em>if</em> is:</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">if (&lt;condition&gt;)
  &lt;statement&gt;
else if (&lt;condition&gt;) # This must not be present
  &lt;statement&gt;
else                  # This either
  &lt;statement&gt;</code></pre></div></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Example
x &lt;- 5
if (x == 0) {
  print("x is Zero")
} else if (x &lt; 0) {
  print("x is negative")
} else {
  print("x is positive")
}
[1] "x is positive"</code></pre></div></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">Note the curly brackets<br>
The indentation helps readability</td></tr></table></div></div></section><section id="_vectorized_if"><h2>Vectorized if</h2><div class="slide-content"><div class="ulist"><ul><li><p>Sometimes we need to apply conditions to vectors</p><div class="ulist"><ul><li><p>Could be done with loops, but sometimes unnecessary</p></li></ul></div></li><li><p>Example: we now that <em>9999</em> is a flag for a missing<br>
value, so we change it to <em>Not Available</em></p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">x &lt;- c(1:3, 9999, 8:6, 9999, 15)
print(x)
[1]    1    2    3 9999    8    7    6 9999   15

ifelse(x == 9999, NA, x)
[1]  1  2  3 NA  8  7  6 NA 15</code></pre></div></div></div></section><section id="_for_loop"><h2><em>for</em> loop</h2><div class="slide-content"><div class="ulist"><ul><li><p>Used when the length of the variable to iterate is known</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">for (i in 1:5) {
    j &lt;- 2**i
    print(j)
}
[1] 2
[1] 4
[1] 8
[1] 16
[1] 32</code></pre></div></div></div></section><section id="_while_loop"><h2><em>while</em> loop</h2><div class="slide-content"><div class="ulist"><ul><li><p>The condition is evaluated before executing the code</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">k &lt;- 1
x &lt;- 0

while (k &gt; 1e-5) {
    k &lt;- 0.1 * k
    x &lt;- x + k
    print(paste(k, x))
}
[1] "0.1 0.1"
[1] "0.01 0.11"
[1] "0.001 0.111"
[1] "1e-04 0.1111"
[1] "1e-05 0.11111"
[1] "1e-06 0.111111"</code></pre></div></div></div></section><section id="_repeat_loop"><h2><em>repeat</em> loop</h2><div class="slide-content"><div class="ulist"><ul><li><p>Similar to <em>while</em> but condition is within the body</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">z &lt;- 1

repeat {
    z &lt;- 0.1*z
    print(z)
    if (z &lt; 1e-5) break
}
[1] 0.1
[1] 0.01
[1] 0.001
[1] 1e-04
[1] 1e-05
[1] 1e-06</code></pre></div></div></div></section><section id="_switch"><h2><em>switch</em></h2><div class="slide-content"><div class="ulist"><ul><li><p>Tests an expression against elements of a list</p></li><li><p>If the value from the expression matches an element<br>
from the list, the corresponding value is returned</p></li><li><p>Basic syntax is <code>switch (expression, list)</code></p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">print(switch(0,"red","green","blue")) # if no match, NULL is returned
NULL
print(switch(1,"red","green","blue"))
[1] "red"
print(switch(2,"red","green","blue"))
[1] "green"
print(switch(4,"red","green","blue"))
NULL

# The list can also be named and therefore use strings for matching
switch("color", "color" = "red", "shape" = "square", "length" = 5)
[1] "red"

switch("length", "color" = "red", "shape" = "square", "length" = 5)
[1] 5</code></pre></div></div></div></section><section id="_mixed_example" class="columns is-vcentered"><h2>Mixed example</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Transpose a matrix
# Self made version of the built-in t() function

mytranspose &lt;- function(x) {
    if (!is.matrix(x)) {
        warning("argument is not a matrix: returning NA")
        return(NA_real_)
    }
    y &lt;- matrix(1, nrow=ncol(x), ncol=nrow(x))
    for (i in 1:nrow(x)) {
        for (j in 1:ncol(x)) {
            y[j,i] &lt;- x[i,j]
        }
    }
    return(y)
}

mytranspose(1:4)
[1] NA
Warning message:
In mytranspose(1:4) : argument is not a matrix: returning NA</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">mytranspose(array(1:24, dim = c(4,3,2)))
[1] NA
Warning message:
In mytranspose(array(1:24, dim = c(4, 3, 2))) :
  argument is not a matrix: returning NA

z &lt;- matrix(1:15, nrow=5, ncol=3)
print(z)
     [,1] [,2] [,3]
[1,]    1    6   11
[2,]    2    7   12
[3,]    3    8   13
[4,]    4    9   14
[5,]    5   10   15

tz &lt;- mytranspose(z)
print(tz)
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    2    3    4    5
[2,]    6    7    8    9   10
[3,]   11   12   13   14   15</code></pre></div></div></div></div></div></section></section>
<section><section id="_deeper_into_functions"><h2>Deeper into functions</h2><div class="slide-content"><div class="ulist"><ul><li><p>Syntax: <code>function ( argument list ) {body}</code></p></li><li><p>A function can have several arguments</p></li><li><p>They can <em>return</em> an object and/or have a side effect</p><div class="ulist"><ul><li><p><code>min()</code> and <code>sum()</code> <em>return values</em></p></li><li><p><code>print</code> and <code>plot</code> have <em>side effects</em></p></li><li><p><code>hist()</code> has both</p></li></ul></div></li><li><p>The variables inside a function are local</p><div class="ulist"><ul><li><p>No conflicts with the upper environment</p></li><li><p>Also, not accessible from it</p></li></ul></div></li></ul></div></div></section><section id="_check_arguments"><h2>Check arguments</h2><div class="slide-content"><div class="ulist"><ul><li><p>We can use the <code>args</code> function to check the arguments of other functions</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">args(rnorm) # rnorm generated random numbers from the normal distribution
function (n, mean = 0, sd = 1)
NULL

set.seed(42) # Do random numbers less random
rnorm(5, -3, 4) # Unnamed arguments must be ordered
[1]  2.4838338 -5.2587927 -1.5474864 -0.4685496 -1.3829267

set.seed(42)
rnorm(sd = 4, mean = -3, n = 5) # Named not
[1]  2.4838338 -5.2587927 -1.5474864 -0.4685496 -1.3829267

args(plot)
function (x, y, ...)
NULL</code></pre></div></div>
<div class="ulist"><ul><li><p>The <code>&#8230;&#8203;</code> means that other arguments can be passed on to other functions</p><div class="ulist"><ul><li><p>Pro: makes R very flexible</p></li><li><p>Con: quickly becomes complicated to track what is going on behind the scenes</p></li></ul></div></li></ul></div></div></section><section id="_more_about_arguments" class="columns is-vcentered"><h2>More about arguments</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Arguments can be hardcoded</p><div class="ulist"><ul><li><p>So, if no arguments given still work</p></li></ul></div></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">sum_pow &lt;- function(x,y) {
    return(sum(x**y))
}
sum_pow(1:5, 3)
[1] 225

sum_pow &lt;- function(x=1:5, y=3) {
    return(sum(x**y))
}
sum_pow()
[1] 225</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Lazy evaluation of function</p><div class="ulist"><ul><li><p>Arguments are only evaluated when needed</p></li></ul></div></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">random_function &lt;- function(a, b) {
    print(a^2)
    print(a)
    print(b)
}
random_function(6)

[1] 36
[1] 6
Error in print(b) : argument "b" is missing, with no default</code></pre></div></div>
<div class="ulist"><ul><li><p>Error only encountered when <code>b</code> was evaluated</p></li></ul></div></div></div></div></section></section>
<section><section id="_some_statistics"><h2>Some statistics</h2><div class="slide-content"><div class="ulist"><ul><li><p>Linear model fit &#8594; <code>lm(x ~ y, data=df)</code></p></li><li><p>Generalised linear model &#8594; <code>glm(x ~ y, data=df)</code></p></li><li><p>Detailed information of models and dataframes &#8594; <code>summary()</code></p></li><li><p>T-test for difference between means &#8594; <code>t.test(x,y)</code></p></li><li><p>T-test for paired data &#8594; <code>pairwise.t.test()</code></p></li><li><p>Test for difference between proportions &#8594; <code>prop.test()</code></p></li><li><p>Analysis of variance &#8594; <code>aov()</code></p></li><li><p>More&#8230;&#8203; &#8594; check package <code>stats</code></p></li></ul></div><div class="paragraph"><p><br></p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">Give them a try!</td></tr></table></div></div></section><section id="_built_in_distributions"><h2>Built-in distributions</h2><div class="slide-content"><table class="tableblock frame-none grid-none" style="width:75%"><colgroup><col style="width:20%"><col style="width:20%"><col style="width:20%"><col style="width:20%"><col style="width:20%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Distribution</th><th class="tableblock halign-left valign-top">Random variates</th><th class="tableblock halign-left valign-top">Density function</th><th class="tableblock halign-left valign-top">Cumulative distribution</th><th class="tableblock halign-left valign-top">Quantile</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Normal</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">rnorm</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">dnorm</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">pnorm</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">qnorm</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Lognormal</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">rlnorm</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">dlnorm</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">plnorm</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">qlnorm</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Poison</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">rpois</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">dpois</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">ppois</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">qpois</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Binomial</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">rbinom</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">dbinom</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">pbinom</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">qbinom</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Uniform</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">runif</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">dunif</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">punif</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">qunif</p></td></tr></table>
<div class="paragraph"><p><br></p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">For more distributions check <a href="https://cran.r-project.org/web/views/Distributions.html">here</a></td></tr></table></div></div></section></section>
<section><section id="_base_r_plotting" class="columns is-vcentered"><h2>Base-R plotting</h2><div class="slide-content"><div class="ulist column"><ul><li><p>Base-R includes plotting routines for:</p><div class="ulist"><ul><li><p>Line graphs &#8594; <code>plot()</code></p></li><li><p>Scatter plots &#8594; <code>plot()</code></p></li><li><p>Histograms &#8594; <code>hist()</code></p></li><li><p>Density plots &#8594; <code>density()</code></p></li><li><p>Quantile&#8201;&#8212;&#8201;Quantile plots &#8594; <code>qqplot()</code></p></li><li><p>Pie charts &#8594; <code>pie()</code></p></li><li><p>Bar charts &#8594; <code>barplot()</code></p></li><li><p>Boxplots &#8594; <code>boxplot()</code></p></li><li><p>More&#8230;&#8203;</p></li></ul></div></li><li><p>Multiple plots in one with <code>par()</code></p></li></ul></div><div class="ulist column"><ul><li><p>Generic plots &#8594; <code>plot()</code>, depends on the type of data</p><div class="ulist"><ul><li><p>x and y: the coordinates of points to plot</p></li><li><p>type: the type of graph to create</p><div class="ulist"><ul><li><p><code>type="p"</code>: for points (by default)</p></li><li><p><code>type="l"</code>: for lines</p></li><li><p><code>type="b"</code>: for both, points are connected by a line</p></li><li><p><code>type="o"</code>: for both <em>overplotted</em></p></li><li><p><code>type="h"</code>: for <em>histogram</em> like vertical lines</p></li><li><p><code>type="s"</code>: for stair steps</p></li><li><p><code>type="n"</code>: for no plotting</p></li></ul></div></li></ul></div></li></ul></div></div></section><section id="_line_graphs_and_save" class="columns is-vcentered"><h2>Line graphs and save</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Change path accordingly
setwd("Documents/PhD/Students/R_course/FRM/images/")

x &lt;- c(5,19,21,1,35)
y &lt;- c(19,2,8,7,10)

# Save as png, note the dpi and sizes
png(file = "dummy_line.png", res=150, width=800,
    height=800, units = "px", pointsize = "14")

plot(x, type = "o",col = "red", xlab = "Dummy x-axis",
     ylab = "Dummy y-axis", main = "Dummy data")

# add second vector
lines(y, type = "o", col = "blue", pch=10, cex=3)

dev.off() # to save the file
RStudioGD
        2</code></pre></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/dummy_line.png" alt="dummy line" height="800"></div></div></div></div></section><section id="_scatter_plots" class="columns is-vcentered"><h2>Scatter plots</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># let's use the mtcars dataset
?mtcars

x &lt;- mtcars$wt * 1000
y &lt;- mtcars$mpg

png(file = "dummy_scatter.png", res=300, width=1600,
    height=1600, units = "px", pointsize = "12")

plot(x, y, xlab = "Weight (lbs)",
     ylab = "mpg (miles/gallon)",
     main = paste0("Please excuse the non-SI units"),
     pch = 19, frame = FALSE, ylim = c(0, max(y)))

# Add more points to the plot
points(x, y/3, col="red", pch=4)

# Add linear fit, play more with the lm function
abline(lm(y ~ x), col = "blue")

dev.off()</code></pre></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/dummy_scatter.png" alt="dummy scatter" height="800"></div></div></div></div></section><section id="_histogram_and_density_plots" class="columns is-vcentered"><h2>Histogram and density plots</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Plot should be different to mine if
# seed number is changed
set.seed(42)

png(filename = "dummy_hist.png")

# Change breaks and note the differences
hist(rnorm(1000), breaks = 25)

dev.off()</code></pre></div></div>
<div class="imageblock"><img src="./images/dummy_hist.png" alt="dummy hist" height="400"></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">set.seed(42)
# Random numbers from the negative binomial distribution
dens &lt;- density(rnbinom(1000, size = 3,
                        prob = 0.64))

png(filename = "dummy_hist.png")

plot(dens, frame = FALSE, col = "steelblue",
     main = "Random density plot")
polygon(dens, col = "steelblue") # to fill the plot
dev.off()</code></pre></div></div>
<div class="imageblock"><img src="./images/dummy_dens.png" alt="dummy dens" height="400"></div></div></div></div></section><section id="_quantilequantile" class="columns is-vcentered"><h2>Quantile&#8201;&#8212;&#8201;Quantile</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># ToothGrowth dataset
?ToothGrowth

png("dummy_qq.png")
qqnorm(ToothGrowth$len, pch = 1)
qqline(ToothGrowth$len, col = "purple", lwd = 2)

dev.off()</code></pre></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/dummy_qq.png" alt="dummy qq" height="800"></div></div></div></div></section><section id="_pie_charts" class="columns is-vcentered"><h2>Pie charts</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">to_pie &lt;- c(7,2,1,10,4)

png(filename = "dummy_pie.png")
pie(to_pie, labels = c("a", "b", "c", "d", "e"),
    col = c("red", "green", "gray", "blue", "#E69F00"),
    radius = .95, main = "Pie example")

dev.off()</code></pre></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/dummy_pie.png" alt="dummy pie" height="800"></div></div></div></div></section><section id="_barplots" class="columns is-vcentered"><h2>Barplots</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Other dataset
?VADeaths

my_colors &lt;- c("lightblue", "mistyrose", "lightcyan",
               "lavender", "cornsilk")
png("dummy_bar.png")
barplot(VADeaths, col = my_colors, beside = TRUE,
        main = "Death Rates in Virginia",
        xlab = "Group", ylab = "Age")

# Add legend
legend("topleft", legend = rownames(VADeaths),
       fill = my_colors)

dev.off()</code></pre></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/dummy_bar.png" alt="dummy bar" height="800"></div></div></div></div></section><section id="_boxplots" class="columns is-vcentered"><h2>Boxplots</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># mtcars dataset again
png(file = "dummy_boxplot.png")

# We can also do plots with the ~ sign
boxplot(mpg ~ cyl, data = mtcars,
        xlab = "Number of Cylinders",
        ylab = "mpg",
        main = "Mileage Data",
        notch = TRUE,
        varwidth = TRUE,
        col = c("red2","yellow","purple"))

dev.off()</code></pre></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/dummy_boxplot.png" alt="dummy boxplot" height="800"></div></div></div></div></section><section id="_multiple_plots" class="columns is-vcentered"><h2>Multiple plots</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">set.seed(42)
x &lt;- rnorm(500)

png("dummy_multi.png")

par(mfrow=c(2,2))
plot(x)
hist(x)
qqnorm(x)
boxplot(x)

dev.off()</code></pre></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/dummy_multi.png" alt="dummy multi" height="800"></div></div></div></div></section><section id="_more_about_generic_plots" class="columns is-vcentered"><h2>More about generic plots</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Sometimes, depending on the dataset, a complex comparative plot is generated automatically</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># iris dataset
?iris

png("iris.png")
plot(iris)
dev.off()</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/iris.png" alt="iris" height="800"></div></div></div></div></section><section id="_last_remarks_about_base_plotting"><h2>Last remarks about base plotting</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>The built-in help system is your friend</p></li><li class="fragment"><p>There are a lot more details and parameters to play with:</p><div class="ulist"><ul><li><p>Margins</p></li><li><p>Types of <code>pch</code></p></li><li><p><code>cex</code> &#8594; scaling of plotting characters</p></li><li><p><code>lty</code> &#8594; line type</p></li><li><p><code>lwd</code> &#8594; line width</p></li><li><p><code>xlim</code> and <code>ylim</code></p></li></ul></div></li><li class="fragment"><p>Plots can be saved as:</p><div class="ulist"><ul><li><p><code>png()</code> &#8594; used here so far</p></li><li><p><code>jpeg()</code> &#8594; used mostly for photographs, not that useful here</p></li><li><p><code>tiff()</code> &#8594; similar to <em>png</em>, some journals ask for it</p></li><li><p><code>svg()</code> &#8594; vector, allows editing</p></li><li><p><code>pdf()</code> &#8594; vector, very useful</p></li></ul></div></li><li class="fragment"><p>Will go in more detail with <code>ggplot2</code> &#8594; allows more modifications</p></li></ul></div></div></section></section>
<section id="_exercise_i"><h2>Exercise I</h2><div class="slide-content"><div class="olist arabic"><ol class="arabic"><li><p>List all CSV files using <code>list.files.</code> Check the options <code>full.names</code> &amp; <code>recursive</code></p></li><li><p>Loop over the listed files and read them as dataframes or time series</p></li><li><p>Pick CSV files of your choice and:</p><div class="olist loweralpha"><ol class="loweralpha" type="a"><li><p>Plot different types of plots</p></li><li><p>Run some statistical tests.</p></li><li><p>Explore the climate conditions of your area</p></li></ol></div></li><li><p>You may do some aggregation, e.g., monthly, seasonally, and annually</p></li><li><p>You can perform trend analysis or any time series analysis you would like.</p></li><li><p>You may convert the variables to common units such as Celsius or mm/day</p></li></ol></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="fa fa-exclamation-circle" title="Important"></i></td><td class="content"><div class="title">Climate Variables:</div><div class="olist arabic"><ol class="arabic"><li><p>sfcWind &#8594; Surface wind [m/s]</p></li><li><p>pr &#8594; Precipitation [kg m-2 s-1]</p></li><li><p>tas &#8594; Surface temperature [k]</p></li></ol></div></td></tr></table></div></div></section>
<section><section id="_tidyverse"><h2>Tidyverse</h2><div class="slide-content"><div class="quoteblock"><blockquote>The tidyverse is an opinionated collection of R packages designed for <strong>data science</strong>. All packages share an underlying design philosophy, grammar, and data structures.</blockquote><div class="attribution">&#8212; tidiverse.org</div></div><div class="paragraph"><p><br></p></div><div class="ulist"><ul><li><p><code>ggplot2</code> &#8594; system for declaratively creating graphics</p></li><li><p><code>purrr</code> &#8594; tools to work with functions and vectors</p></li><li><p><code>tibble</code> &#8594; re-design of data frames</p></li><li><p><code>dplyr</code> &#8594; data manipulation</p></li><li><p><code>tidyr</code> &#8594; functions to <em>tidy</em> the data up</p></li><li><p><code>stringr</code> &#8594; to work with strings easily</p></li><li><p><code>readr</code> &#8594; easy way to read data like <em>csv</em>, <em>tsv</em>, <em>fwf</em></p></li><li><p><code>forcats</code> &#8594; tools to solve issues with <em>factors</em></p></li></ul></div></div></section><section id="_tidy_philosophy"><h2><em>Tidy</em> philosophy</h2><div class="slide-content"><div class="ulist"><ul><li><p><em>Tidy</em> data is where:</p><div class="olist arabic"><ol class="arabic"><li><p>Every column is a variable</p></li><li><p>Every row is an observation</p></li><li><p>Every cell is a single value</p></li></ol></div></li><li><p>Check <code>vignette("tidy-data")</code></p><div class="ulist"><ul><li><p>It is often said that 80% of data analysis is<br>
spent on the cleaning and preparing data&#8230;&#8203;</p></li></ul></div></li><li><p>Check this <a href="https://r4ds.had.co.nz/">book</a></p></li><li><p><code>lubridate</code> is not part of <code>tidyverse</code> but very<br>
useful to work with dates</p><div class="ulist"><ul><li><p><code>hms</code> to work with time of day values</p></li></ul></div></li></ul></div></div></section><section id="_pipes"><h2>Pipes</h2><div class="slide-content"><div class="ulist"><ul><li><p>The pipe operator <code>%&gt;%</code> eases readability and coding</p><div class="ulist"><ul><li><p><code>x %&gt;% f</code> is equivalent to <code>f(x)</code></p></li><li><p><code>x %&gt;% f(y)</code> is equivalent to <code>f(x, y)</code></p></li><li><p><code>x %&gt;% f %&gt;% g %&gt;% h</code> is equivalent to <code>h(g(f(x)))</code></p></li><li><p><code>x %&gt;% f(y, .)</code> is equivalent to <code>f(y, x)</code></p></li><li><p><code>x %&gt;% f(y, z = .)</code> is equivalent to <code>f(y, z = x)</code></p></li></ul></div></li></ul></div></div></section></section>
<section><section id="_analysing_the_gapminder_dataset"><h2>Analysing the <em>Gapminder</em> dataset</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">install.packages("gapminder")
library(gapminder)
library(tidyverse)
?gapminder

head(gapminder)
# A tibble: 6 x 6
  country     continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.
2 Afghanistan Asia       1957    30.3  9240934      821.
3 Afghanistan Asia       1962    32.0 10267083      853.
4 Afghanistan Asia       1967    34.0 11537966      836.
5 Afghanistan Asia       1972    36.1 13079460      740.
6 Afghanistan Asia       1977    38.4 14880372      786.

str(as.data.frame(gapminder))
'data.frame':|1704 obs. of  6 variables:
 $ country  : Factor w/ 142 levels "Afghanistan",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ continent: Factor w/ 5 levels "Africa","Americas",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ lifeExp  : num  28.8 30.3 32 34 36.1 ...
 $ pop      : int  8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...
 $ gdpPercap: num  779 821 853 836 740 ...</code></pre></div></div></div></section><section id="_filtering_according_to_values"><h2>Filtering according to values</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">gapminder %&gt;%
    filter(
        str_detect(country, "Costa"),
        year %in% c(1987, 1997, 2007)
    )

# A tibble: 3 x 6
  country    continent  year lifeExp     pop gdpPercap
  &lt;fct&gt;      &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt;
1 Costa Rica Americas   1987    74.8 2799811     5630.
2 Costa Rica Americas   1997    77.3 3518107     6677.
3 Costa Rica Americas   2007    78.8 4133884     9645.

gapminder %&gt;%
    filter(
        str_detect(country, "Costa"),
        year %in% c(1987, 1997, 2007)
    ) %&gt;%
    summarize(AvgLife=mean(lifeExp))

# A tibble: 1 x 1
  AvgLife
    &lt;dbl&gt;
1    76.9</code></pre></div></div></div></section><section id="_grouping"><h2>Grouping</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">gapminder %&gt;%
    filter(year %in% c(1997,2007)) %&gt;%
    group_by(continent, year) %&gt;%
    summarize(AvgLife = mean(lifeExp),
              GDP = mean(gdpPercap))

# A tibble: 10 x 4
# Groups:   continent [5]
   continent  year AvgLife    GDP
   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1 Africa     1997    53.6  2379.
 2 Africa     2007    54.8  3089.
 3 Americas   1997    71.2  8889.
 4 Americas   2007    73.6 11003.
 5 Asia       1997    68.0  9834.
 6 Asia       2007    70.7 12473.
 7 Europe     1997    75.5 19077.
 8 Europe     2007    77.6 25054.
 9 Oceania    1997    78.2 24024.
10 Oceania    2007    80.7 29810.</code></pre></div></div></div></section><section id="_arranging_data"><h2>Arranging data</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">gapminder %&gt;%
    filter(year == 2007) %&gt;%
    group_by(continent) %&gt;%
    summarise(totalPop = sum(pop)) %&gt;%
    arrange(desc(totalPop))

# Note the desc() descending

# A tibble: 5 x 2
  continent   totalPop
  &lt;fct&gt;          &lt;dbl&gt;
1 Asia      3811953827
2 Africa     929539692
3 Americas   898871184
4 Europe     586098529
5 Oceania     24549947</code></pre></div></div></div></section><section id="_creating_new_columns"><h2>Creating new columns</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">gapminder %&gt;%
    filter(year == 2007) %&gt;%
    mutate(totalGdp = pop * gdpPercap/1000000) # To have it in millions

# A tibble: 142 x 7
   country     continent  year lifeExp       pop gdpPercap totalGdp
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 Afghanistan Asia       2007    43.8  31889923      975.   31079.
 2 Albania     Europe     2007    76.4   3600523     5937.   21376.
 3 Algeria     Africa     2007    72.3  33333216     6223.  207445.
 4 Angola      Africa     2007    42.7  12420476     4797.   59584.
 5 Argentina   Americas   2007    75.3  40301927    12779.  515034.
 6 Australia   Oceania    2007    81.2  20434176    34435.  703658.
 7 Austria     Europe     2007    79.8   8199783    36126.  296229.
 8 Bahrain     Asia       2007    75.6    708573    29796.   21113.
 9 Bangladesh  Asia       2007    64.1 150448339     1391.  209312.
10 Belgium     Europe     2007    79.4  10392226    33693.  350141.
# … with 132 more rows</code></pre></div></div></div></section><section id="_top_10_life_expectancy"><h2>Top 10 life expectancy</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">gapminder %&gt;%
    filter(year == 2007) %&gt;%
    mutate(percentile = ntile(lifeExp, 100)) %&gt;%
    filter(percentile &gt; 90) %&gt;%
    arrange(desc(percentile)) %&gt;%
    top_n(10, wt = percentile) %&gt;%
    select(continent, country, lifeExp, percentile)

# A tibble: 10 x 4
   continent country          lifeExp percentile
   &lt;fct&gt;     &lt;fct&gt;              &lt;dbl&gt;      &lt;int&gt;
 1 Asia      Japan               82.6        100
 2 Asia      Hong Kong, China    82.2         99
 3 Europe    Iceland             81.8         98
 4 Europe    Switzerland         81.7         97
 5 Oceania   Australia           81.2         96
 6 Europe    Spain               80.9         95
 7 Europe    Sweden              80.9         94
 8 Asia      Israel              80.7         93
 9 Europe    France              80.7         92
10 Americas  Canada              80.7         91</code></pre></div></div></div></section><section id="_last_10_life_expectancy"><h2>Last 10 life expectancy</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">gapminder %&gt;%
    filter(year == 2007) %&gt;%
    mutate(percentile = ntile(lifeExp, 100)) %&gt;%
    filter(percentile &lt; 10) %&gt;%
    arrange(percentile) %&gt;%
    top_n(-10, wt = percentile) %&gt;%
    select(continent, country, lifeExp, percentile)

# A tibble: 10 x 4
   continent country                  lifeExp percentile
   &lt;fct&gt;     &lt;fct&gt;                      &lt;dbl&gt;      &lt;int&gt;
 1 Africa    Mozambique                  42.1          1
 2 Africa    Swaziland                   39.6          1
 3 Africa    Sierra Leone                42.6          2
 4 Africa    Zambia                      42.4          2
 5 Africa    Angola                      42.7          3
 6 Africa    Lesotho                     42.6          3
 7 Asia      Afghanistan                 43.8          4
 8 Africa    Zimbabwe                    43.5          4
 9 Africa    Central African Republic    44.7          5
10 Africa    Liberia                     45.7          5</code></pre></div></div></div></section></section>
<section><section id="_example_of_un_tidy_data"><h2>Example of <em>un-tidy</em> data</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">relig_income
# Column headers are values, not variable names
# A tibble: 18 x 11
   religion           `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`
   &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 Agnostic                27        34        60        81        76       137        122
 2 Atheist                 12        27        37        52        35        70         73
 3 Buddhist                27        21        30        34        33        58         62
 4 Catholic               418       617       732       670       638      1116        949
 5 Don’t know/refused      15        14        15        11        10        35         21
 6 Evangelical Prot       575       869      1064       982       881      1486        949
 7 Hindu                    1         9         7         9        11        34         47
 8 Historically Blac…     228       244       236       238       197       223        131
 9 Jehovahs Witness       20        27        24        24        21        30         15
10 Jewish                  19        19        25        25        30        95         69
11 Mainline Prot          289       495       619       655       651      1107        939
12 Mormon                  29        40        48        51        56       112         85
13 Muslim                   6         7         9        10         9        23         16
14 Orthodox                13        17        23        32        32        47         38
15 Other Christian          9         7        11        13        13        14         18
16 Other Faiths            20        33        40        46        49        63         46
17 Other World Relig…       5         2         3         4         2         7          3
18 Unaffiliated           217       299       374       365       341       528        407
# … with 3 more variables: $100-150k &lt;dbl&gt;, &gt;150k &lt;dbl&gt;, Don't know/refused &lt;dbl&gt;</code></pre></div></div></div></section><section id="_tidying_it_up"><h2><em>Tidying</em> it up</h2><div class="slide-content"><div class="ulist"><ul><li><p><code>pivot_longer()</code> helps us to change it to a <em>long</em> format<br>
which later will be needed for <code>ggplot</code></p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">relig_income %&gt;%
    pivot_longer(!religion, names_to = "income", values_to = "count") %&gt;%
    group_by(religion) %&gt;%
    mutate(total=sum(count), percent= count/total*100)

# A tibble: 180 x 5
# Groups:   religion [18]
   religion income             count total percent
   &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 Agnostic &lt;$10k                 27   826    3.27
 2 Agnostic $10-20k               34   826    4.12
 3 Agnostic $20-30k               60   826    7.26
 4 Agnostic $30-40k               81   826    9.81
 5 Agnostic $40-50k               76   826    9.20
 6 Agnostic $50-75k              137   826   16.6
 7 Agnostic $75-100k             122   826   14.8
 8 Agnostic $100-150k            109   826   13.2
 9 Agnostic &gt;150k                 84   826   10.2
10 Agnostic Dont know/refused    96   826   11.6
# … with 170 more rows</code></pre></div></div></div></section></section>
<section id="_more_about_data_wrangling"><h2>More about data <em>wrangling</em></h2><div class="slide-content"><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">Data wrangling is the process of cleaning and unifying messy and<br>
complex data sets for easy access and analysis.</td></tr></table></div>
<div class="paragraph"><p><br></p></div>
<div class="ulist"><ul><li><p>Useful functions within <code>tidyverse</code> for data <em>wrangling</em>:</p></li></ul></div>
<div class="ulist col2"><ul><li><p><code>arrange</code> &#8594; order rows by values (low to high, <code>desc</code> for high to low)</p></li><li><p><code>distinct</code> &#8594; remove duplicate rows</p></li><li><p><code>filter</code> &#8594; extract rows</p></li><li><p><code>slice</code> &#8594; select rows by position</p></li><li><p><code>pull</code> &#8594; extract column values as vector</p></li><li><p><code>relocate</code> &#8594; change order of columns</p></li><li><p><code>mutate</code> &#8594; add new column</p></li><li><p><code>transmute</code> &#8594; compute new column, drop others</p></li><li><p><code>*_join</code> &#8594; join columns to table (several options)</p></li></ul></div>
<div class="ulist col2"><ul><li><p><code>rename</code> &#8594; rename columns, use <code>rename_with</code> with function</p></li><li><p><code>cum*</code> &#8594; cumulative aggregate (several options)</p></li><li><p><code>lag</code> &#8594; offset elements by 1</p></li><li><p><code>lead</code> &#8594; offset elements by -1</p></li><li><p><code>n</code> &#8594; number of rows</p></li><li><p><code>n_distinct</code> &#8594; number of uniques</p></li><li><p><code>dense_rank</code> &#8594; rank with no gaps</p></li><li><p><code>percent_rank</code> &#8594; rank scaled to [0,1]</p></li><li><p>More&#8230;&#8203;</p></li></ul></div></div></section>
<section><section id="_intro_to_ggplot2"><h2>Intro to <em>ggplot2</em></h2><div class="slide-content"><div class="ulist"><ul><li><p>Based on <a href="https://www.springer.com/gp/book/9780387245447"><em>The Grammar of Graphics</em></a></p></li><li><p>Major components of <em>ggplot</em>:</p><div class="ulist"><ul><li><p><code>data</code> &#8594; data to plot</p></li><li><p>Geometries <code>geom_</code> &#8594; The geometric shapes that will represent the data</p></li><li><p>Aesthetics <code>aes()</code> &#8594; Aesthetics of the geometric and statistical objects</p><div class="ulist"><ul><li><p>Position, color, size, shape, and transparency</p></li></ul></div></li><li><p>Scales <code>scale_</code> &#8594; Maps between the data and the aesthetic dimensions</p></li><li><p>Statistical transformations <code>stat_</code> &#8594; Statistical summaries of the data</p><div class="ulist"><ul><li><p>Quantiles, fitted curves, and sums</p></li></ul></div></li><li><p>Coordinate system <code>coord_</code> &#8594; Coordinate transformation</p></li><li><p>Facets <code>facet_</code> &#8594; plot the data into a grid</p></li><li><p>Visual themes <code>theme()</code> &#8594; visual defaults of a plot</p><div class="ulist"><ul><li><p>Background, grids, axes, default typeface, sizes and colors</p></li></ul></div></li></ul></div></li></ul></div></div></section><section id="_basic_plots" class="columns is-vcentered"><h2>Basic plots</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">library(tidyverse)
setwd("Documents/PhD/Students/R_course/FRM/images/")

gapminder_07 &lt;- gapminder %&gt;%
    filter(year == 2007)

ex_plot &lt;- ggplot(gapminder_07, aes(x = lifeExp)) +
    geom_histogram(bins = 30)

ggsave(plot = ex_plot, filename = "gg_hist_1.png",
       width = 80, height = 80,
       units = "mm", dpi = 300)</code></pre></div></div>
<div class="imageblock"><img src="./images/gg_hist_1.png" alt="gg hist 1" height="500"></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Let&#8217;s add some colors</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">ex_plot &lt;- ggplot(gapminder_07, aes(x = lifeExp,
                                  fill=continent)) +
    geom_histogram(bins = 30)

ggsave(plot = ex_plot, filename = "gg_hist_2.png",
       width = 100, height = 80,
       units = "mm", dpi = 300)</code></pre></div></div>
<div class="imageblock"><img src="./images/gg_hist_2.png" alt="gg hist 2" height="500"></div></div></div></div></section><section id="_title_and_other_tweaks" class="columns is-vcentered"><h2>Title and other tweaks</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">ex_plot &lt;- ggplot(gapminder_07, aes(x = lifeExp,
                                  fill=continent)) +
    geom_histogram(bins = 30) +
    ggtitle("Life expectancy histogram \n per continent") +
    labs(subtitle = "Why do you think it's like that?",
         caption = "Ideas?") +
    theme_light(base_size = 12) +
    theme(plot.title = element_text(hjust = 0.5,
                                    face = "bold.italic",
                                    colour = "purple"))

ggsave(plot = ex_plot, filename = "gg_hist_3.png",
       width = 100, height = 80,
       units = "mm", dpi = 300)</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/gg_hist_3.png" alt="gg hist 3" height="650"></div></div></div></div></section><section id="_other_geom_types" class="columns is-vcentered"><h2>Other <em>geom</em> types</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">ex_plot &lt;- ggplot(gapminder_07, aes(y = lifeExp,
                                  x = gdpPercap,
                                  color= continent,
                                  size= pop)) +
    geom_point() +
    labs(x = "GDP per capita ($)",
         y = "Life expectancy (years)",
         color= "Continent",
         size = "Population",
         title = "GDP vs Life expectancy") +
    guides(color = guide_legend(order = 1)) +
    scale_x_log10() +
    theme_light(base_size = 12)</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/gg_point_1.png" alt="gg point 1" height="650"></div></div></div></div></section><section id="_adding_fits" class="columns is-vcentered"><h2>Adding fits</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Options: <code>lm</code>, <code>glm</code>, <code>loess</code>, etc.</p></li><li><p>Check <code>?geom_smooth</code></p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">ex_plot &lt;- ggplot(gapminder_07, aes(y = lifeExp,
                                  x = gdpPercap)) +
    geom_point(color="firebrick2") +
    labs(x = "GDP per capita ($)",
         y = "Life expectancy (years)",
         color= "Continent",
         size = "Population",
         title = "GDP vs Life expectancy") +
    geom_smooth(method = "lm", color= "purple2") +
    scale_x_log10() +
    theme_light(base_size = 12)

ggsave(plot = ex_plot, filename = "gg_point_2.png",
       width = 100, height = 100, units = "mm", dpi = 300)</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/gg_point_2.png" alt="gg point 2" height="650"></div></div></div></div></section><section id="_boxplots_2" class="columns is-vcentered"><h2>Boxplots</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">ex_plot &lt;- ggplot(gapminder_07, aes(y = lifeExp,
                                  group = continent,
                                  x = continent,
                                  color = continent)) +
    geom_boxplot(outlier.colour = "black", outlier.shape = 8) +
    labs(y = "Life expectancy (years)",
         title = "Boxplot of life expectancy by continent") +
    guides(color = FALSE) +
    theme_light(base_size = 12)

ggsave(plot = ex_plot, filename = "gg_box_1.png",
       width = 100, height = 100, units = "mm", dpi = 300)</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/gg_box_1.png" alt="gg box 1" height="650"></div></div></div></div></section><section id="_violin_plots" class="columns is-vcentered"><h2>Violin plots</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">ex_plot &lt;- ggplot(gapminder_07 %&gt;% filter(!continent=="Oceania"),
                aes(y = lifeExp,
                    group = continent,
                    x = continent,
                    color = continent)) +
    geom_violin(draw_quantiles = c(0.25, 0.5, 0.75)) +
    geom_jitter(size = 0.5) +
    scale_color_manual(values = c("deeppink", "midnightblue",
                                  "plum", "forestgreen")) +
    labs(y = "Life expectancy (years)",
         title = "Violin plot of life expectancy by continent",
         x = NULL) +
    guides(color = FALSE) +
    theme_light(base_size = 12)

ggsave(plot = ex_plot, filename = "gg_vio_1.png",
       width = 100, height = 100, units = "mm", dpi = 300)</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/gg_vio_1.png" alt="gg vio 1" height="650"></div></div></div></div></section><section id="_facets_and_more_tweaks" class="columns is-vcentered"><h2>Facets and more tweaks</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">ex_plot &lt;- ggplot(gapminder %&gt;% filter(!continent=="Oceania",
                                     year %in% c(1997,2007)),
                aes(y = lifeExp,
                    group = continent,
                    x = gdpPercap,
                    color = continent)) +
    geom_point(size = 0.5) +
    labs(y = "Life expectancy (years)",
         title = "Faceted plot of life exp. vs GDP",
         x = "GDPpC ($)") +
    guides(color = FALSE) +
    scale_x_log10(labels = scales::scientific) +
    geom_smooth(method = "lm") +
    facet_grid(year ~ continent) +
    theme_light(base_size = 12) +
    theme(strip.background = element_rect(fill = "white"),
          strip.text = element_text(color= "black"),
          axis.text.x = element_text(angle = 90, vjust = 0.5),
          axis.title.x =
              element_text(margin = margin(5,0,0,0, unit = "mm")))

ggsave(plot = ex_plot, filename = "gg_facet_1.png",
       width = 100, height = 100, units = "mm", dpi = 300)</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/gg_facet_1.png" alt="gg facet 1" height="650"></div></div></div></div></section></section>
<section><section id="_spatial_data_in"><h2>Spatial data in <span class="image"><img src="./images/r-seeklogo.svg" alt="r seeklogo" height="45"></span></h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>There is a great amount of packages to work with spatial data</p></li><li class="fragment"><p>Might not be as user friendly as QGIS, but really pays off to learn</p></li><li class="fragment"><p>Packages needed:</p><div class="ulist"><ul><li><p><code>terra</code></p></li><li><p><code>sf</code></p></li></ul></div></li><li class="fragment"><p>Some of those packages need installation of other software outside of R</p><div class="ulist"><ul><li><p>This might be time consuming&#8230;&#8203;</p></li></ul></div></li><li class="fragment"><p>Both <em>vector</em> and <em>raster</em> data can be:</p><div class="ulist"><ul><li><p>Read to R</p></li><li><p>Modified</p></li><li><p>Created from scratch</p></li><li><p>Saved into desired format</p></li></ul></div></li></ul></div></div></section><section id="_dimensions_of_environmental_data"><h2>Dimensions of Environmental Data</h2><div class="slide-content"><div class="ulist"><ul><li><p>1D data such as measurement of river flow, temperature, and rainfall, could<br>
be presented as time series</p></li><li><p>2D data such as rainfall measured by satellite or remote sensing. It has<br>
longitude (x-axis) and latitude dimensions (y-axis).</p></li><li><p>3D data, similar to 2D with respect to x and y axes; however depth or elevation<br>
is considered. E.g. atmospheric data, oceanic data, and soil profiles.</p></li></ul></div>
<div class="paragraph"><p><br></p></div>
<div class="admonitionblock note"><table><tr><td class="icon"><i class="fa fa-info-circle" title="Note"></i></td><td class="content">All these dimensions can additionally include the time axis</td></tr></table></div></div></section></section>
<section><section id="_rasters" class="columns is-vcentered"><h2><em>Rasters</em></h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">library(terra)

# Creating a raster from a matrix
r1 &lt;- rast(matrix(rnorm(19*13), nrow = 19), crs = "EPSG:4326")
# define extent
ext(r1)&lt;-c(xmin=5, xmax=15, ymin=-5, ymax=10)

r1
class       : SpatRaster
dimensions  : 19, 13, 1  (nrow, ncol, nlyr)
resolution  : 0.7692308, 0.7894737  (x, y)
extent      : 5, 15, -5, 10  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326)
source      : memory
name        :     lyr.1
min value   : -2.777259
max value   :  2.850702

plot(r1, main = "Raster made from a matrix")
# Plot the center of the pixels
points(crds(r1), pch=3, cex=0.5)</code></pre></div></div>
<div class="ulist"><ul><li><p>For other sources check <code>?terra</code></p></li></ul></div></div></div><div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/matrix_raster_terra.png" alt="matrix raster terra" height="900"></div></div></div></div></section><section id="_read_raster_data"><h2>Read raster data</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Run these 4 lines in this order to install the "hires" version of "rnaturalearth"
install.packages("Rtools")
install.packages("devtools")
devtools::install_github("ropenscilabs/rnaturalearth")
devtools::install_github("ropenscilabs/rnaturalearthhires")

library(sf)
library(terra)
library(rnaturalearth)

setwd("/home/dqc/Documents/PhD/Students/R_course/FRM/spatial/")

de_dem &lt;- rast("deutschland_dgm.asc")
crs(de_dem) &lt;-  "ESRI:31494"

print(de_dem)

class       : SpatRaster
dimensions  : 910, 720, 1  (nrow, ncol, nlyr)
resolution  : 1000, 1000  (x, y)
extent      : 4030000, 4750000, 5230000, 6140000  (xmin, xmax, ymin, ymax)
coord. ref. : Germany_Zone_4 (ESRI:31494)
source      : deutschland_dgm.asc
name        : deutschland_dgm</code></pre></div></div></div></section><section id="_exploring_the_raster"><h2>Exploring the raster</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">global(de_dem, 'range', na.rm=TRUE) # min and max
                range     max
deutschland_dgm -178.46 2770.35
global(de_dem, 'mean', na.rm=TRUE)
                  mean
deutschland_dgm 312.5505
# if #1 didnot work use #2
global(de_dem, fun='median', na.rm=TRUE) #1
median(values(de_dem), na.rm = TRUE)#2
[1] 256.21

de_dem &lt;- setMinMax(de_dem) # add range permanently to SpatRaster
print(de_dem)
class       : SpatRaster
dimensions  : 910, 720, 1  (nrow, ncol, nlyr)
resolution  : 1000, 1000  (x, y)
extent      : 4030000, 4750000, 5230000, 6140000  (xmin, xmax, ymin, ymax)
coord. ref. : Germany_Zone_4 (ESRI:31494)
source      : deutschland_dgm.asc
name        : deutschland_dgm
min value   :         -178.46
max value   :         2770.35</code></pre></div></div></div></section><section id="_raster_math"><h2>Raster math</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">sqrt(de_dem)
class       : SpatRaster
dimensions  : 910, 720, 1  (nrow, ncol, nlyr)
resolution  : 1000, 1000  (x, y)
extent      : 4030000, 4750000, 5230000, 6140000  (xmin, xmax, ymin, ymax)
coord. ref. : Germany_Zone_4 (ESRI:31494)
source      : memory
name        : deutschland_dgm
min value   :         0.00000
max value   :        52.63412

de_dem + de_dem*4 # Need to have same dimensions
class       : SpatRaster
dimensions  : 910, 720, 1  (nrow, ncol, nlyr)
resolution  : 1000, 1000  (x, y)
extent      : 4030000, 4750000, 5230000, 6140000  (xmin, xmax, ymin, ymax)
coord. ref. : Germany_Zone_4 (ESRI:31494)
source      : memory
name        : deutschland_dgm
min value   :         -892.30
max value   :        13851.75</code></pre></div></div></div></section><section id="_plotting_with_terra_package"><h2>Plotting with <em>terra</em> package</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">par(mfrow=c(1,3))
raster::hist(de_dem, main="Distribution of elevation \n values",
             breaks=40,maxpixels=1000000)
raster::boxplot(de_dem, ylab= "Elevation", main = "Boxplot")
raster::plot(de_dem, main = "Basic plot")</code></pre></div></div>
<div class="imageblock columns is-vcentered"><img src="./images/histbox_dem_terra.png" alt="histbox dem terra" width="900" height="450"></div></div></section><section id="_reprojecting_rasters" class="columns is-vcentered"><h2>Reprojecting rasters</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">dem_repro &lt;- terra::project(de_dem,
                           "+proj=longlat +datum=WGS84")
dem_repro

class       : SpatRaster
dimensions  : 732, 901, 1  (nrow, ncol, nlyr)
resolution  : 0.01127346, 0.01128598  (x, y)
extent      : 5.499419, 15.6568, 47.03692, 55.29826  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs
source      : memory
name        : deutschland_dgm
min value   :        -138.226
max value   :        2689.770

png("../images/reproj_dem_terra.png", width = 800,
    height= 800, res = 150)

terra::plot(dem_repro, col= terrain.colors(12))
dev.off()</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="imageblock"><img src="./images/reproj_dem_terra.png" alt="reproj dem terra" height="650"></div></div></div></div></section><section id="_save_rasters"><h2>Save rasters</h2><div class="slide-content"><div class="ulist"><ul><li><p>Check the options here: <code>?writeFormats</code></p></li></ul></div>
<table class="tableblock frame-none grid-none" style="width:90%"><colgroup><col style="width:12.5%"><col style="width:37.5%"><col style="width:25%"><col style="width:25%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">File type</th><th class="tableblock halign-left valign-top">Long name</th><th class="tableblock halign-left valign-top">Default extension</th><th class="tableblock halign-left valign-top">Multiband support</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">raster</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">'Native' raster package format</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">.grd</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">ascii</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">ESRI Ascii</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">.asc</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">SAGA</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">SAGA GIS</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">.sdat</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">CDF</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">netCDF (requires ncdf4)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">.nc</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">GTiff</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">GeoTiff (requires rgdal)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">.tif</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">ENVI</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">ENVI .hdr Labelled</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">.envi</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">EHdr</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">ESRI .hdr Labelled</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">.bil</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">HFA</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Erdas Imagine Images (.img)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">.img</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td></tr></table>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">writeRaster(x = dem_repro,
            "dem_repro_terra.tif",
            overwrite = TRUE)</code></pre></div></div></div></section><section id="_calculating_terrain_characteristics"><h2>Calculating terrain characteristics</h2><div class="slide-content"><div class="ulist"><ul><li><p>With the <code>terrain()</code> function we can calculate:</p></li></ul></div>
<table class="tableblock frame-none grid-none" style="width:100%"><colgroup><col style="width:33.3333%"><col style="width:33.3333%"><col style="width:33.3334%"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>Slope</p></li></ul></div></div></td><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>Aspect</p></li></ul></div></div></td><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>Roughness</p></li></ul></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>TRI (Terrain Ruggedness Index)</p></li></ul></div></div></td><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>TPI (Topographic Position Index)</p></li></ul></div></div></td><td class="tableblock halign-left valign-top"><div><div class="ulist"><ul><li><p>flowdir (flow direction of water)</p></li></ul></div></div></td></tr></table>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">terrain_all &lt;- terrain(dem_repro, unit='degrees',
                       v=c("slope", "aspect", "TPI",
                             "TRI", "roughness", "flowdir"))
class       : SpatRaster
dimensions  : 732, 901, 6  (nrow, ncol, nlyr)
resolution  : 0.01127346, 0.01128598  (x, y)
extent      : 5.499419, 15.6568, 47.03692, 55.29826  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs
source      : memory
names       :   slope,       aspect,       TPI,      TRI, roughness, flowdir
min values  :  0.0000, 7.219100e-05, -373.8375,   0.0000,     0.000,       1
max values  : 30.8288, 3.599996e+02,  453.8708, 475.6112,  1472.003,     128

class(terrain_all)[1] "SpatRaster"
attr(,"package")
[1] "terra"

plot(terrain_all)</code></pre></div></div></div></section><section id="_visualizing_rasters"><h2>Visualizing <em>rasters</em></h2><div class="slide-content"><div class="imageblock"><img src="./images/terrain_terra.png" alt="terrain terra" width="1400" height="800"></div></div></section><section id="_selecting_layer_of_spatraster_and_adding_plots" class="columns is-vcentered"><h2>Selecting layer of <em>SpatRaster</em> and adding plots</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">library(rnaturalearth)
bundes &lt;- ne_states(country="germany") # Obtain borders

plot(terrain_all$TRI)
plot(bundes, add=TRUE)

class(bundes) # Notice the class of the object
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"

# SpatRaster can also be created:
c(terrain_all$roughness, terrain_all$TPI)
class       : SpatRaster
dimensions  : 732, 901, 2  (nrow, ncol, nlyr)
resolution  : 0.01127346, 0.01128598  (x, y)
extent      : 5.499419, 15.6568, 47.03692, 55.29826  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs
sources     : memory
              memory
names       : roughness,       TPI
min values  :     0.000, -373.8375
max values  :  1472.003,  453.8708</code></pre></div></div>
<div class="imageblock"><img src="./images/tri_bundes_terra.png" alt="tri bundes terra" width="800" height="800"></div></div></section><section id="_extent_crop_and_mask" class="columns is-vcentered"><h2>Extent, crop and mask</h2><div class="slide-content"><div class="listingblock column"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">ext(dem_repro)
class      : Extent
xmin       : 4.545173
xmax       : 16.01377
ymin       : 46.97347
ymax       : 55.46003

crop_extent &lt;- ext(c(8,12,50,54))
cropped_dem &lt;- crop(dem_repro, crop_extent)

plot(cropped_dem, main= "Cropped to extent")
plot(bundes, add=TRUE)

masked_dem &lt;- mask(dem_repro, vect(bundes))
plot(masked_dem, main= "Masked to polygon")</code></pre></div></div>
<div class="imageblock column"><img src="./images/crop_mask_terra.png" alt="crop mask terra" height="850"></div></div></section></section>
<section><section id="_vector_data" class="columns"><h2>Vector data</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Read with <code>vect()</code> from <code>terra</code> package</p><div class="ulist"><ul><li><p>Resulting object is of class <code>SpatVector</code></p></li><li><p>Works with <em>base-R</em> plotting</p></li></ul></div></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">library(terra)
kreis_ogr &lt;- vect("./spatial/kreis.gpkg")
class(kreis_ogr)
[1] "SpatVector"
attr(,"package")
[1] "terra"

plot(kreis_ogr, main = "Default sp plot")</code></pre></div></div>
<div class="imageblock"><img src="./images/kreis_ogr_terra.png" alt="kreis ogr terra" height="550"></div></div></div><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Read with <code>read_sf()</code> from <code>sf</code> package</p><div class="ulist"><ul><li><p><code>sf</code> is newer and is getting to be the new standard</p></li><li><p>Note the classes <code>sf</code> and <code>tbl</code> (<em>tibble</em>)</p></li><li><p><em>tibble</em> and <em>data frame</em> are compatible with <em>tidyverse</em></p></li><li><p><strong><em>Recommended</em></strong></p></li></ul></div></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">kreis_sf &lt;- read_sf("./spatial/kreis.gpkg")
class(kreis_sf)
[1] "sf"    "tbl_df"    "tbl"   "data.frame"

plot(kreis_sf, max.plot = 1)</code></pre></div></div>
<div class="imageblock"><img src="./images/kreis_sf.png" alt="kreis sf" height="450"></div></div></div></div></section><section id="_transformations" class="columns is-vcentered"><h2>Transformations</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>From <code>terra</code> to another projection</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">library(tidyverse)
kreis_ogrT &lt;- project(kreis_ogr,
                      "EPSG:4326")

plot(dem_repro, xlim = c(11.5,15.5),
     ylim=c(50,52))
plot(kreis_ogrT, add=TRUE)</code></pre></div></div>
<div class="imageblock"><img src="./images/dem_kreis_ogr_terra.png" alt="dem kreis ogr terra" width="500"></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>From <code>sf</code> to another projection</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">kreis_sfT &lt;- st_transform(kreis_sf,
    sp::CRS(SRS_string = "EPSG:4326"))

plot(dem_repro, xlim = c(11.5,15.5),
     ylim=c(50,52))
plot(kreis_sfT, add=TRUE, col=NA)
# Try without col=NA</code></pre></div></div>
<div class="imageblock"><img src="./images/dem_kreis_sf.png" alt="dem kreis sf" width="500"></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>From <code>terra</code> to <code>sf</code></p></li><li><p>Note that the class is not exactly the same but the content is:</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">kreis_sf_2 &lt;- st_as_sf(kreis_ogr)
class(kreis_sf_2)
[1] "sf"         "data.frame"

kreis_sf == kreis_sf_2
      SCHLUESSEL KREIS geom
 [1,]       TRUE  TRUE TRUE
 [2,]       TRUE  TRUE TRUE
 [3,]       TRUE  TRUE TRUE
 [4,]       TRUE  TRUE TRUE
 [5,]       TRUE  TRUE TRUE
 [6,]       TRUE  TRUE TRUE
 [7,]       TRUE  TRUE TRUE
 [8,]       TRUE  TRUE TRUE
 [9,]       TRUE  TRUE TRUE
[10,]       TRUE  TRUE TRUE
[11,]       TRUE  TRUE TRUE
[12,]       TRUE  TRUE TRUE
[13,]       TRUE  TRUE TRUE</code></pre></div></div></div></div></div></section><section id="_subset_vector_data" class="columns is-vcentered"><h2>Subset vector data</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>From <code>sp</code> with <em>base-R</em></p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">kreis_ogrSub &lt;- kreis_ogrT[grep("Kreisfreie",
                                kreis_ogrT$KREIS)]

plot(dem_repro, col= terrain.colors(12),
     xlim = c(11.5,15.5), ylim=c(50,52),
     main = "Main cities in Sachsen from terra")
plot(kreis_ogrSub, add=TRUE)</code></pre></div></div>
<div class="imageblock"><img src="./images/dem_kreis_ogr_sub_terra.png" alt="dem kreis ogr sub terra" width="600"></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>From <code>sf</code> with <em>piping</em> (<code>%&gt;%</code>)</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">kreis_sfSub &lt;- kreis_sfT %&gt;%
    filter(str_detect(KREIS, "Kreisfreie"))

plot(dem_repro, col= terrain.colors(12),
     xlim = c(11.5,15.5), ylim=c(50,52),
     main = "Main cities in Sachsen from sf")
plot(kreis_sfT, add=TRUE, col =NA)
plot(st_geometry(kreis_sfSub), add=TRUE, col = "red")</code></pre></div></div>
<div class="imageblock"><img src="./images/dem_kreis_sf_sub.png" alt="dem kreis sf sub" width="600"></div></div></div></div></section><section id="_modifying_and_saving_vector_data" class="columns is-vcentered"><h2>Modifying and saving vector data</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Adding a new column
kreis_sfSub$Car_plate &lt;- c("C", "DD", "L")

# Changing order of columns and removing some characters
kreis_sfSub &lt;- kreis_sfSub %&gt;%
    relocate(Car_plate, .before = geom) %&gt;%
    mutate(KREIS = str_remove(KREIS, "Kreisfreie Stadt "))

print(kreis_sfSub)
# A tibble: 3 x 4
  SCHLUESSEL KREIS    Car_plate        geom
* &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;            &lt;MULTIPOLYGON [°]&gt;
1 14511      Chemnitz C    (((12.89504 50.90242, 12.89611 50.90111…
2 14612      Dresden  DD   (((13.75092 51.17734, 13.75448 51.17717…
3 14713      Leipzig  L    (((12.49304 51.43103, 12.49341 51.42809…

# Manually changing a point -&gt; not so straightforward...
kreis_sfSub$geom[[1]][[1]][[1]][1,2] &lt;- c(51.25)
kreis_sfSub$geom[[1]][[1]][[1]][292,2] &lt;- c(51.25)

plot(dem_repro, col= terrain.colors(12),
     xlim = c(11.5,15.5), ylim=c(50,52),
     main = "Manually modified geometry")
plot(st_geometry(kreis_sfSub), add= TRUE)</code></pre></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Writing vector data to file:</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># append = FALSE to overwrite
st_write(kreis_sfSub, append = FALSE,
    dsn = "./spatial/kreis_SubMod.gpkg")</code></pre></div></div>
<div class="imageblock"><img src="./images/modified_geom.png" alt="modified geom"></div></div></div></div></section><section id="_creating_vectors"><h2>Creating vectors</h2><div class="slide-content"><div class="ulist"><ul><li><p>It can be done with both <code>terra</code> and <code>sf</code> packages</p></li><li><p>Still, due to its simplicity and contemporarity, focus will be on <code>sf</code></p></li><li><p>As seen before, <code>sf</code> objects are <em>tibble</em> like structure<br>
with a <code>geom</code> column which contains a <em>list</em></p></li><li><p>Steps:</p><div class="olist arabic"><ol class="arabic"><li><p>Create geometric objects</p><div class="ulist"><ul><li><p><code>st_point()</code>, <code>st_linestring()</code>, <code>st_polygon()</code> and more</p></li></ul></div></li><li><p>Combine objects for the <code>geom</code> column</p><div class="ulist"><ul><li><p><code>st_sfc()</code></p></li></ul></div></li><li><p>Add other columns</p><div class="ulist"><ul><li><p><code>st_sf()</code></p></li></ul></div></li></ol></div></li></ul></div></div></section><section id="_example" class="columns is-vcentered"><h2>Example</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># Let's use random numbers

set.seed(31)
line1 &lt;- st_linestring(matrix(rnorm(6), ncol=2))
line2 &lt;- st_linestring(matrix(rnorm(6), ncol=2))

class(line1)
[1] "XY"         "LINESTRING" "sfg"

lines_sfc &lt;- st_sfc(line1, line2)
class(lines_sfc)
[1] "sfc_LINESTRING" "sfc"

lines_sfc
Geometry set for 2 features
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: -1.274471 ymin: -1.068968
    xmax: 1.595762 ymax: 1.506267
CRS:           NA
LINESTRING (0.05557024 0.9648359....
LINESTRING (0.3903673 -0.7308096....
# CRS can be set</code></pre></div></div></div></div>
<div class="openblock column"><div class="content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">set.seed(19)
df &lt;- data.frame(id = c("A", "B"),
                 RV = runif(2))

lines_sf &lt;- st_sf(df, lines_sfc)

plot(lines_sf)</code></pre></div></div>
<div class="imageblock"><img src="./images/lines_sf.png" alt="lines sf" height="575"></div></div></div></div></section></section>
<section><section id="_plotting_spatial_data_with_ggplot2"><h2>Plotting spatial data with <em>ggplot2</em></h2><div class="slide-content"><div class="ulist"><ul><li><p><em>Rasters</em> should be transformed to a <em>data frame</em> format</p><div class="ulist"><ul><li><p><code>geom_raster</code> has some limitations &#8594; better use <code>geom_tile</code></p></li></ul></div></li><li><p>Easy to plot vectors when they are in <code>sf</code> format</p><div class="ulist"><ul><li><p><code>geom_sf</code></p></li></ul></div></li></ul></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">cropped &lt;- crop(dem_repro, kreis_sfT)
masked_dem_sn &lt;- mask(cropped, kreis_sfT)

masked.spdf&lt;- as(masked_dem_sn, "SpatialPixelsDataFrame") %&gt;%
    as.data.frame() %&gt;% rename(elev = deutschland_dgm)

raster_gg &lt;- ggplot(masked.spdf) +
    geom_tile(aes(fill=elev, x=x, y=y)) +
    geom_sf(data = kreis_sfT, fill=NA,
            colour="black", size = 0.5) +
    geom_sf_label(data = kreis_sfSub, aes(label=KREIS),
                  fill=NA, color= "red2", label.size = 0) +
    coord_sf() +
    labs(x=NULL, y=NULL, fill="m.a.s.l.",
         title = "Raster with different vectors") +
    theme_light(base_size = 11) +
    scale_fill_gradientn(colours = terrain.colors(12))</code></pre></div></div></div></section><section id="_previous_example"><h2>Previous example</h2><div class="slide-content"><div class="imageblock"><img src="./images/raster_gg.png" alt="raster gg" height="900"></div></div></section><section id="_another_example"><h2>Another example</h2><div class="slide-content"><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R">library(ggspatial)

masked.spdf.de &lt;- as(masked_dem, "SpatialPixelsDataFrame") %&gt;%
    as.data.frame() %&gt;% rename(elev = deutschland_dgm)

world &lt;- ne_countries(scale = "medium", returnclass = "sf")
bundes&lt;- ne_states(country="germany", returnclass = "sf")

raster_gg &lt;- ggplot(masked.spdf.de) +
    geom_sf(data = world, fill=NA, size=0.25) +
    geom_tile(aes(fill=elev, x=x, y=y)) +
    geom_sf(data = bundes, fill=NA, size=0.25) +
    annotation_scale(location = "bl", width_hint = 0.35) +
    annotation_north_arrow(location = "tl", which_north = "true",
                           pad_x = unit(1, "mm"), pad_y = unit(2, "mm"),
                           style = north_arrow_fancy_orienteering) +
    coord_sf(xlim = c(0, 20), ylim = c(45, 60)) +
    labs(x=NULL, y=NULL, fill="m.a.s.l.",
         title = "Fancy details with other vectors") +
    theme_light(base_size = 11) +
    scale_fill_gradientn(colours = terrain.colors(7))</code></pre></div></div></div></section><section id="_fancy_plot"><h2>Fancy plot</h2><div class="slide-content"><div class="imageblock"><img src="./images/raster_gg_2.png" alt="raster gg 2" height="900"></div></div></section></section>
<section><section id="_netcdf_data"><h2>NetCDF data</h2><div class="slide-content"><div class="ulist"><ul><li class="fragment"><p>NetCDF (<strong>*Net</strong>work <strong>C</strong>ommon <strong>D</strong>ata <strong>F</strong>orm) is a set of software libraries and machine-independent data formats that support the creation, access, and sharing of array-oriented scientific data. <a href="https://www.unidata.ucar.edu/software/netcdf/">Unidata-NetCDF</a></p></li><li class="fragment"><p>Scientific data (variables) can be temperature, + humidity, pressure, wind speed, and direction.</p></li><li class="fragment"><p>The netCDF format is:</p><div class="ulist"><ul><li><p>Self-Describing &#8658; Containing metadata according to the <a href="https://cfconventions.org/">NetCDF Climate and Forecast (CF) Metadata Conventions</a></p></li><li><p>Scalable &#8658; Subsetting large datasets is efficient.</p></li><li><p>Appendable &#8658; Neither copying nor reading the data is required for appending.</p></li><li><p>Sharable &#8658; Parallel Reading</p></li><li><p>Archivable &#8658; Supported for a long term.</p></li></ul></div></li></ul></div><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Always look for a data format that in compliance with the Resarch Data Managament of your instuite. For example, <a href="https://tu-dresden.de/tu-dresden/qualitaetsmanagement/ressourcen/dateien/wisprax/Leitlinien-fuer-den-Umgang-mit-Forschungsdaten-an-der-TU-Dresden.pdf?lang=en">Reserach Data Guidlines, TU Dresden</a></td></tr></table></div></div></section><section id="_netcdf_structure"><h2>NetCDF Structure</h2><div class="slide-content"><div class="imageblock"><img src="./images/netcdf-file-structure.png" alt="netcdf file structure" height="800"></div></div></section><section id="_netcdf_and_ncdf4_package" class="columns"><h2>NetCDF and <code>ncdf4</code> package</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>It is the R interface to netCDF files.</p></li><li><p>It follows the CF convections.</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># file name
library(ncdf4)
library(ncdf4.helpers)

setwd("your/path/to/example/file")
f&lt;-"example.nc"

# open file
ncin&lt;-nc_open(f)

print(ncin)</code></pre></div></div>
<div class="imageblock"><img src="./images/ncin_output.png" alt="ncin output" width="700"></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p>Getting data:</p></li></ul></div>
<div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-R hljs" data-noescape="true" data-lang="R"># get longitude and latitude
lon &lt;- ncvar_get(ncin,"lon")
head(lon)
[1]  0  2  4  6  8 10
# get latitude
lat &lt;- ncvar_get(ncin,"lat")
head(lat)
[1]  -89 -87 -85 -83 -81 -79
# get time
time &lt;- ncvar_get(ncin,"time")
head(time)
[1] 46020.5 46021.5 46022.5 46023.5
# convert time
time_converted&lt;-ncdf4.helpers::nc.get.time.series(f = ncin)
head(time_converted)
[1] "1976-01-01 12:00:00" "1976-01-02 12:00:00"
 "1976-01-03 12:00:00" "1976-01-04 12:00:00"
# get precipitation
tmp_array &lt;- ncvar_get(ncin,"pr")
# convert to mm/day
tmp_array &lt;-tmp_array*86400</code></pre></div></div></div></div></div></section><section id="_netcdf_and_terra_package"><h2>NetCDF and <code>terra</code> package</h2></section></section>
<section><section id="_general_info_regarding_excerises"><h2>General Info Regarding Excerises</h2><div class="slide-content"><div class="ulist"><ul><li><p>You should utilise the exercises to help you prepare for the final presentations.</p></li><li><p>The minimum expectations of the presentation are:</p><div class="olist loweralpha"><ol class="loweralpha" type="a"><li><p>Choosing one climate variable and one RCP scenario, for example, precipitation (pr) with RCP2.6.</p></li><li><p>Performing the three exercises and presenting adequate results.</p></li><li><p>Submitting your presentation and the code you used to analyse the data and prepare the plots.</p></li></ol></div></li></ul></div><div class="imageblock"><img src="./images/Tree.png" alt="Tree" width="800"></div><div class="admonitionblock important"><table><tr><td class="icon"><i class="fa fa-exclamation-circle" title="Important"></i></td><td class="content">Be curious, let the internet be your friend!</td></tr></table></div></div></section><section id="_exercise_i_2"><h2>Exercise I</h2><div class="slide-content"><div class="olist arabic"><ol class="arabic"><li><p>Pick one scenario and variable for your group.</p></li><li><p>List all CSV files using <code>list.files.</code> Check the options <code>full.names</code> &amp; <code>pattern</code>.</p></li><li><p>Loop over the listed files and read them as data frames or time series.</p></li><li><p>Compare the different periods using statistical measurements (e.g., mean, median) and statistical tests (e.g., t.test)</p></li><li><p>Plot different types of plots to support your findings. For example, time series, boxplots, densities, etc</p></li><li><p>You may do some aggregation, e.g., monthly, seasonally, and annually</p></li><li><p>You can perform trend analysis or any time series analysis you would like.</p></li><li><p>You may convert the variables to common units such as Celsius or mm/day.</p></li></ol></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="fa fa-exclamation-circle" title="Important"></i></td><td class="content"><div class="title">Climate Variables:</div><div class="olist arabic"><ol class="arabic"><li><p>sfcWind &#8594; Surface wind [m/s]</p></li><li><p>pr &#8594; Precipitation [kg m-2 s-1]</p></li><li><p>tas &#8594; Surface temperature [k]</p></li></ol></div></td></tr></table></div></div></section><section id="_exercise_ii"><h2>Exercise II</h2><div class="slide-content"><div class="olist arabic"><ol class="arabic"><li><p>Use the same scenario and variable you opted in Exercise I.</p></li><li><p>Extract netCDF files content as arrays using terra.</p></li><li><p>Consider each pixel as a time series as in Exercise I and perform a similar analysis.</p></li><li><p>Plot your results as maps using <code>ggplot2</code></p><div class="olist loweralpha"><ol class="loweralpha" type="a"><li><p>You may add borders, rivers, and any features that complement your maps.</p></li></ol></div></li></ol></div></div></section><section id="_exercise_iii"><h2>Exercise III</h2><div class="slide-content"><div class="olist arabic"><ol class="arabic"><li><p>Use the same scenario and variable you opted in Exercise I  &amp; II.</p></li><li><p>Pick a location in the globe you want to present, knowing its longitude and latitude.</p></li><li><p>Read the netCDF files you choose using <code>terra</code> package and extract them as arrays.</p></li><li><p>Extract the vertical profiles for your locations and plot them, comparing the different periods.</p></li><li><p>You may want to calculate wind speed and direction from ua and va. + Don&#8217;t hesitate to do it!</p></li></ol></div>
<div class="admonitionblock important"><table><tr><td class="icon"><i class="fa fa-exclamation-circle" title="Important"></i></td><td class="content"><div class="title">Climate Variables:</div><div class="olist arabic"><ol class="arabic"><li><p>hus&#8594; Specific humitidiy [g/kg]</p></li><li><p>ta&#8594; Temperature [k]</p></li><li><p>ua &amp; va &#8594; u and v wind componemnts [m/s]</p></li></ol></div></td></tr></table></div></div></section></section>
<section id="_last_remarks"><h2>Last remarks</h2><div class="slide-content"><div class="ulist"><ul><li><p>There usually is more than one way to achieve similar results</p></li><li><p>What was shown here was just a short overview of what can<br>
be done with spatial data</p><div class="ulist"><ul><li><p>Most of the functions in <em>QGIS</em> are available in R</p></li></ul></div></li><li><p>There are many more useful functions on <code>sf</code> to explore</p></li><li><p>There is much more to learn about <code>ggplot2</code> and <code>tidyverse</code></p></li><li><p>Hydrological analysis can be carried out with R</p><div class="ulist"><ul><li><p>Watershed delineation</p></li><li><p>Voronoi polygons</p></li><li><p>Extreme events distribution fit and analysis</p></li></ul></div></li></ul></div></div></section>
<section id="_references_and_other_info"><h2>References and other info</h2><div class="slide-content"><div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><a href="https://www.javatpoint.com/r-data-types">Data types</a></p></li><li><p><a href="https://swcarpentry.github.io/r-novice-inflammation/13-supp-data-structures/">Data structures in R</a></p></li><li><p><a href="https://resbaz.github.io/2014-r-materials/lessons/01-intro_r/data-structures.html">Data structures in R 2</a></p></li><li><p><a href="http://www.r-tutor.com/elementary-statistics">Elementary Statistics with R</a></p></li><li><p><a href="https://tpetzoldt.github.io/RBasics/">Dr. Thomas Petzoldt&#8217;s Rbasics (TU Dresden)</a></p></li><li><p><a href="https://learningstatisticswithr.com/book/">Statistics with R, book</a></p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><a href="https://rstudio-pubs-static.s3.amazonaws.com/322396_ca6932a8cca04ee2b33d9cebdef8142b.html">Exploring the MPG dataset</a></p></li><li><p><a href="https://www.tidyverse.org/">Tidyverse</a></p></li><li><p><a href="https://www.r-bloggers.com/2021/04/tidyverse-in-r-complete-tutorial/">Tidyverse tutorial</a></p></li><li><p><a href="https://www.tutorialspoint.com/ggplot2/index.htm">ggplot2 tutorial</a></p></li><li><p><a href="https://www.oreilly.com/library/view/r-for-data/9781491910382/ch01.html">Data visualization with ggplot2</a></p></li><li><p><a href="http://sape.inf.usi.ch/quick-reference/ggplot2/colour">ggplot2 colors</a></p></li><li><p><a href="https://www.neonscience.org/resources/learning-hub/tutorials/raster-data-r">Raster data in R</a></p></li></ul></div></div></div>
<div class="openblock column"><div class="content"><div class="ulist"><ul><li><p><a href="https://rspatial.org/raster/spatial/index.html">Rspatial</a></p></li><li><p><a href="https://www.jessesadler.com/post/gis-with-r-intro/">GIS with R</a></p></li><li><p><a href="https://vt-hydroinformatics.github.io/rgeowatersheds.html">Watershed delineation</a></p></li><li><p><a href="https://www.r-graph-gallery.com/line-chart-dual-Y-axis-ggplot2.html">Dual y-axis ggplot2</a></p></li><li><p><a href="https://www.rstudio.com/resources/cheatsheets/">Cheatsheets</a></p></li><li><p><a href="http://r-statistics.co/Time-Series-Analysis-With-R.html">Time series analysis</a></p></li><li><p><a href="https://www.statmethods.net/advstats/timeseries.html">Time series analysis 2</a></p></li><li><p><a href="https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/">Another ggplot tutorial</a></p></li></ul></div></div></div></div></section></div></div><script src="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
});

// More info about config & dependencies:
// - https://github.com/hakimel/reveal.js#configuration
// - https://github.com/hakimel/reveal.js#dependencies
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'true',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Add the current slide number to the URL hash so that reloading the
  // page/copying the URL will return you to the same slide
  hash: true,
  // Push each slide change to the browser history. Implies `hash: true`
  history: false,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Disables the default reveal.js slide layout so that you can use custom CSS layout
  disableLayout: false,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // See https://github.com/hakimel/reveal.js/#navigation-mode
  navigationMode: 'default',
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Global override for preloading lazy-loaded iframes
  // - null: Iframes with data-src AND data-preload will be loaded when within
  //   the viewDistance, iframes with only data-src will be loaded when visible
  // - true: All iframes with data-src will be loaded when within the viewDistance
  // - false: All iframes with data-src will be loaded only when visible
  preloadIframes: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Specify the total time in seconds that is available to
  // present.  If this is set to a nonzero value, the pacing
  // timer will work out the time available for each slide,
  // instead of using the defaultTiming value
  totalTime: 0,
  // Specify the minimum amount of time you want to allot to
  // each slide, if using the totalTime calculation method.  If
  // the automated time allocation causes slide pacing to fall
  // below this threshold, then you will see an alert in the
  // speaker notes window
  minimumTimePerSlide: 0,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hide cursor if inactive
  hideInactiveCursor: true,
  // Time before the cursor is hidden (in ms)
  hideCursorTime: 5000,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'slide',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Number of slides away from the current that are visible on mobile
  // devices. It is advisable to set this to a lower number than
  // viewDistance in order to save resources.
  mobileViewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1920,
  height: 1080,

  // Factor of the display size that should remain empty around the content
  margin: .1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // PDF Export Options
  // Put each fragment on a separate page
  pdfSeparateFragments: true,
  // For slides that do not fit on a page, max number of pages
  pdfMaxPagesPerSlide: 1,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/zoom-js/zoom.js', async: true },
      { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/plugin/notes/notes.js', async: true }
  ],

  

});</script><script>var dom = {};
dom.slides = document.querySelector('.reveal .slides');

function getRemainingHeight(element, slideElement, height) {
  height = height || 0;
  if (element) {
    var newHeight, oldHeight = element.style.height;
    // Change the .stretch element height to 0 in order find the height of all
    // the other elements
    element.style.height = '0px';
    // In Overview mode, the parent (.slide) height is set of 700px.
    // Restore it temporarily to its natural height.
    slideElement.style.height = 'auto';
    newHeight = height - slideElement.offsetHeight;
    // Restore the old height, just in case
    element.style.height = oldHeight + 'px';
    // Clear the parent (.slide) height. .removeProperty works in IE9+
    slideElement.style.removeProperty('height');
    return newHeight;
  }
  return height;
}

function layoutSlideContents(width, height) {
  // Handle sizing of elements with the 'stretch' class
  toArray(dom.slides.querySelectorAll('section .stretch')).forEach(function (element) {
    // Determine how much vertical space we can use
    var limit = 5; // hard limit
    var parent = element.parentNode;
    while (parent.nodeName !== 'SECTION' && limit > 0) {
      parent = parent.parentNode;
      limit--;
    }
    if (limit === 0) {
      // unable to find parent, aborting!
      return;
    }
    var remainingHeight = getRemainingHeight(element, parent, height);
    // Consider the aspect ratio of media elements
    if (/(img|video)/gi.test(element.nodeName)) {
      var nw = element.naturalWidth || element.videoWidth, nh = element.naturalHeight || element.videoHeight;
      var es = Math.min(width / nw, remainingHeight / nh);
      element.style.width = (nw * es) + 'px';
      element.style.height = (nh * es) + 'px';
    } else {
      element.style.width = width + 'px';
      element.style.height = remainingHeight + 'px';
    }
  });
}

function toArray(o) {
  return Array.prototype.slice.call(o);
}

Reveal.addEventListener('slidechanged', function () {
  layoutSlideContents(1920, 1080)
});
Reveal.addEventListener('ready', function () {
  layoutSlideContents(1920, 1080)
});
Reveal.addEventListener('resize', function () {
  layoutSlideContents(1920, 1080)
});</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@3.9.2/lib/css/monokai.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>

<script>

/* highlightjs-line-numbers.js 2.6.0 | (C) 2018 Yauheni Pakala | MIT License | github.com/wcoder/highlightjs-line-numbers.js */
/* Edited by Hakim for reveal.js; removed async timeout */
!function(n,e){"use strict";function t(){var n=e.createElement("style");n.type="text/css",n.innerHTML=g(".{0}{border-collapse:collapse}.{0} td{padding:0}.{1}:before{content:attr({2})}",[v,L,b]),e.getElementsByTagName("head")[0].appendChild(n)}function r(t){"interactive"===e.readyState||"complete"===e.readyState?i(t):n.addEventListener("DOMContentLoaded",function(){i(t)})}function i(t){try{var r=e.querySelectorAll("code.hljs,code.nohighlight");for(var i in r)r.hasOwnProperty(i)&&l(r[i],t)}catch(o){n.console.error("LineNumbers error: ",o)}}function l(n,e){"object"==typeof n&&f(function(){n.innerHTML=s(n,e)})}function o(n,e){if("string"==typeof n){var t=document.createElement("code");return t.innerHTML=n,s(t,e)}}function s(n,e){e=e||{singleLine:!1};var t=e.singleLine?0:1;return c(n),a(n.innerHTML,t)}function a(n,e){var t=u(n);if(""===t[t.length-1].trim()&&t.pop(),t.length>e){for(var r="",i=0,l=t.length;i<l;i++)r+=g('<tr><td class="{0}"><div class="{1} {2}" {3}="{5}"></div></td><td class="{4}"><div class="{1}">{6}</div></td></tr>',[j,m,L,b,p,i+1,t[i].length>0?t[i]:" "]);return g('<table class="{0}">{1}</table>',[v,r])}return n}function c(n){var e=n.childNodes;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];h(r.textContent)>0&&(r.childNodes.length>0?c(r):d(r.parentNode))}}function d(n){var e=n.className;if(/hljs-/.test(e)){for(var t=u(n.innerHTML),r=0,i="";r<t.length;r++){var l=t[r].length>0?t[r]:" ";i+=g('<span class="{0}">{1}</span>\n',[e,l])}n.innerHTML=i.trim()}}function u(n){return 0===n.length?[]:n.split(y)}function h(n){return(n.trim().match(y)||[]).length}function f(e){e()}function g(n,e){return n.replace(/{(\d+)}/g,function(n,t){return e[t]?e[t]:n})}var v="hljs-ln",m="hljs-ln-line",p="hljs-ln-code",j="hljs-ln-numbers",L="hljs-ln-n",b="data-line-number",y=/\r\n|\r|\n/g;n.hljs?(n.hljs.initLineNumbersOnLoad=r,n.hljs.lineNumbersBlock=l,n.hljs.lineNumbersValue=o,t()):n.console.error("highlight.js not detected!")}(window,document);

/**
 * This reveal.js plugin is wrapper around the highlight.js
 * syntax highlighting library.
 */
(function( root, factory ) {
  if (typeof define === 'function' && define.amd) {
    root.RevealHighlight = factory();
  } else if( typeof exports === 'object' ) {
    module.exports = factory();
  } else {
    // Browser globals (root is window)
    root.RevealHighlight = factory();
  }
}( this, function() {

  // Function to perform a better "data-trim" on code snippets
  // Will slice an indentation amount on each line of the snippet (amount based on the line having the lowest indentation length)
  function betterTrim(snippetEl) {
    // Helper functions
    function trimLeft(val) {
      // Adapted from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim#Polyfill
      return val.replace(/^[\s\uFEFF\xA0]+/g, '');
    }
    function trimLineBreaks(input) {
      var lines = input.split('\n');

      // Trim line-breaks from the beginning
      for (var i = 0; i < lines.length; i++) {
        if (lines[i].trim() === '') {
          lines.splice(i--, 1);
        } else break;
      }

      // Trim line-breaks from the end
      for (var i = lines.length-1; i >= 0; i--) {
        if (lines[i].trim() === '') {
          lines.splice(i, 1);
        } else break;
      }

      return lines.join('\n');
    }

    // Main function for betterTrim()
    return (function(snippetEl) {
      var content = trimLineBreaks(snippetEl.innerHTML);
      var lines = content.split('\n');
      // Calculate the minimum amount to remove on each line start of the snippet (can be 0)
      var pad = lines.reduce(function(acc, line) {
        if (line.length > 0 && trimLeft(line).length > 0 && acc > line.length - trimLeft(line).length) {
          return line.length - trimLeft(line).length;
        }
        return acc;
      }, Number.POSITIVE_INFINITY);
      // Slice each line with this amount
      return lines.map(function(line, index) {
        return line.slice(pad);
      })
        .join('\n');
    })(snippetEl);
  }

  var RevealHighlight = {

    HIGHLIGHT_STEP_DELIMITER: '|',
    HIGHLIGHT_LINE_DELIMITER: ',',
    HIGHLIGHT_LINE_RANGE_DELIMITER: '-',

    init: function() {

      // Read the plugin config options and provide fallbacks
      var config = Reveal.getConfig().highlight || {};
      config.highlightOnLoad = typeof config.highlightOnLoad === 'boolean' ? config.highlightOnLoad : true;
      config.escapeHTML = typeof config.escapeHTML === 'boolean' ? config.escapeHTML : true;

      [].slice.call( document.querySelectorAll( '.reveal pre code' ) ).forEach( function( block ) {

        // Trim whitespace if the "data-trim" attribute is present
        if( block.hasAttribute( 'data-trim' ) && typeof block.innerHTML.trim === 'function' ) {
          block.innerHTML = betterTrim( block );
        }

        // Escape HTML tags unless the "data-noescape" attrbute is present
        if( config.escapeHTML && !block.hasAttribute( 'data-noescape' )) {
          block.innerHTML = block.innerHTML.replace( /</g,"&lt;").replace(/>/g, '&gt;' );
        }

        // Re-highlight when focus is lost (for contenteditable code)
        block.addEventListener( 'focusout', function( event ) {
          hljs.highlightBlock( event.currentTarget );
        }, false );

        if( config.highlightOnLoad ) {
          RevealHighlight.highlightBlock( block );
        }
      } );

    },

    /**
     * Highlights a code block. If the <code> node has the
     * 'data-line-numbers' attribute we also generate slide
     * numbers.
     *
     * If the block contains multiple line highlight steps,
     * we clone the block and create a fragment for each step.
     */
    highlightBlock: function( block ) {

      hljs.highlightBlock( block );

      // Don't generate line numbers for empty code blocks
      if( block.innerHTML.trim().length === 0 ) return;

      if( block.hasAttribute( 'data-line-numbers' ) ) {
        hljs.lineNumbersBlock( block, { singleLine: true } );

        // If there is at least one highlight step, generate
        // fragments
        var highlightSteps = RevealHighlight.deserializeHighlightSteps( block.getAttribute( 'data-line-numbers' ) );
        if( highlightSteps.length > 1 ) {

          // If the original code block has a fragment-index,
          // each clone should follow in an incremental sequence
          var fragmentIndex = parseInt( block.getAttribute( 'data-fragment-index' ), 10 );
          if( typeof fragmentIndex !== 'number' || isNaN( fragmentIndex ) ) {
            fragmentIndex = null;
          }

          // Generate fragments for all steps except the original block
          highlightSteps.slice(1).forEach( function( highlight ) {

            var fragmentBlock = block.cloneNode( true );
            fragmentBlock.setAttribute( 'data-line-numbers', RevealHighlight.serializeHighlightSteps( [ highlight ] ) );
            fragmentBlock.classList.add( 'fragment' );
            block.parentNode.appendChild( fragmentBlock );
            RevealHighlight.highlightLines( fragmentBlock );

            if( typeof fragmentIndex === 'number' ) {
              fragmentBlock.setAttribute( 'data-fragment-index', fragmentIndex );
              fragmentIndex += 1;
            }
            else {
              fragmentBlock.removeAttribute( 'data-fragment-index' );
            }

          } );

          block.removeAttribute( 'data-fragment-index' )
          block.setAttribute( 'data-line-numbers', RevealHighlight.serializeHighlightSteps( [ highlightSteps[0] ] ) );

        }

        RevealHighlight.highlightLines( block );

      }

    },

    /**
     * Visually emphasize specific lines within a code block.
     * This only works on blocks with line numbering turned on.
     *
     * @param {HTMLElement} block a <code> block
     * @param {String} [linesToHighlight] The lines that should be
     * highlighted in this format:
     * "1" 		= highlights line 1
     * "2,5"	= highlights lines 2 & 5
     * "2,5-7"	= highlights lines 2, 5, 6 & 7
     */
    highlightLines: function( block, linesToHighlight ) {

      var highlightSteps = RevealHighlight.deserializeHighlightSteps( linesToHighlight || block.getAttribute( 'data-line-numbers' ) );

      if( highlightSteps.length ) {

        highlightSteps[0].forEach( function( highlight ) {

          var elementsToHighlight = [];

          // Highlight a range
          if( typeof highlight.end === 'number' ) {
            elementsToHighlight = [].slice.call( block.querySelectorAll( 'table tr:nth-child(n+'+highlight.start+'):nth-child(-n+'+highlight.end+')' ) );
          }
          // Highlight a single line
          else if( typeof highlight.start === 'number' ) {
            elementsToHighlight = [].slice.call( block.querySelectorAll( 'table tr:nth-child('+highlight.start+')' ) );
          }

          if( elementsToHighlight.length ) {
            elementsToHighlight.forEach( function( lineElement ) {
              lineElement.classList.add( 'highlight-line' );
            } );

            block.classList.add( 'has-highlights' );
          }

        } );

      }

    },

    /**
     * Parses and formats a user-defined string of line
     * numbers to highlight.
     *
     * @example
     * RevealHighlight.deserializeHighlightSteps( '1,2|3,5-10' )
     * // [
     * //   [ { start: 1 }, { start: 2 } ],
     * //   [ { start: 3 }, { start: 5, end: 10 } ]
     * // ]
     */
    deserializeHighlightSteps: function( highlightSteps ) {

      // Remove whitespace
      highlightSteps = highlightSteps.replace( /\s/g, '' );

      // Divide up our line number groups
      highlightSteps = highlightSteps.split( RevealHighlight.HIGHLIGHT_STEP_DELIMITER );

      return highlightSteps.map( function( highlights ) {

        return highlights.split( RevealHighlight.HIGHLIGHT_LINE_DELIMITER ).map( function( highlight ) {

          // Parse valid line numbers
          if( /^[\d-]+$/.test( highlight ) ) {

            highlight = highlight.split( RevealHighlight.HIGHLIGHT_LINE_RANGE_DELIMITER );

            var lineStart = parseInt( highlight[0], 10 ),
              lineEnd = parseInt( highlight[1], 10 );

            if( isNaN( lineEnd ) ) {
              return {
                start: lineStart
              };
            }
            else {
              return {
                start: lineStart,
                end: lineEnd
              };
            }

          }
          // If no line numbers are provided, no code will be highlighted
          else {

            return {};

          }

        } );

      } );

    },

    /**
     * Serializes parsed line number data into a string so
     * that we can store it in the DOM.
     */
    serializeHighlightSteps: function( highlightSteps ) {

      return highlightSteps.map( function( highlights ) {

        return highlights.map( function( highlight ) {

          // Line range
          if( typeof highlight.end === 'number' ) {
            return highlight.start + RevealHighlight.HIGHLIGHT_LINE_RANGE_DELIMITER + highlight.end;
          }
          // Single line
          else if( typeof highlight.start === 'number' ) {
            return highlight.start;
          }
          // All lines
          else {
            return '';
          }

        } ).join( RevealHighlight.HIGHLIGHT_LINE_DELIMITER );

      } ).join( RevealHighlight.HIGHLIGHT_STEP_DELIMITER );

    }

  }

  Reveal.registerPlugin( 'highlight', RevealHighlight );

  return RevealHighlight;

}));
        
hljs.initHighlightingOnLoad();
</script></body></html>